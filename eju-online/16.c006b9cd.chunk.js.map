{"version":3,"sources":["pages/Login/Register/Register.tsx"],"names":["AgreeItem","Register","useState","formValues","setFormValues","useLazyQuery","USER_RIGISTER","onCompleted","loginRes","registerSuccess","registerReq","history","loading","useHistory","data","goBack","handleChange","value","type","vals","placeholder","name","onChange","val","size","onClick","email","password","userName","surePassword","info","emailReg","test","userNameReg","pwdReg","checkValues","variables","md5","toString","data-seed","e","preventDefault","alert"],"mappings":"6VAUQA,EAAR,IAAQA,UA2HOC,EAzHY,WACzB,MAAoCC,mBAA6B,IAAjE,mBAAOC,EAAP,KAAmBC,EAAnB,KACA,EAAmCC,YAAaC,IAAe,CAC7DC,YAAa,SAACC,GAAD,OAAcC,EAAgBD,MAD7C,mBAAOE,EAAP,KAGMC,GAHN,KAAsBC,QAGNC,eAEVJ,EAAkB,SAACK,GAEvBH,EAAQI,UAgDJC,EAAe,SAACC,EAAeC,GACnCd,GAAc,SAACe,GAAD,mBAAC,eAAeA,GAAhB,kBAAuBD,EAAOD,QAI9C,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,uCACA,uBACEG,YAAY,iCACZC,KAAK,QACLC,SAAU,SAACC,GAAD,OAAeP,EAAaO,EAAK,YAE7C,uBAAYC,KAAK,OACjB,uBACEJ,YAAY,uCACZC,KAAK,WACLC,SAAU,SAACC,GAAD,OAAeP,EAAaO,EAAK,eAE7C,uBAAYC,KAAK,OACjB,uBACEJ,YAAY,iCACZF,KAAK,WACLG,KAAK,WACLC,SAAU,SAACC,GAAD,OAAeP,EAAaO,EAAK,eAE7C,uBAAYC,KAAK,OACjB,uBACEJ,YAAY,6CACZF,KAAK,WACLG,KAAK,eACLC,SAAU,SAACC,GAAD,OAAeP,EAAaO,EAAK,mBAE7C,uBAAYC,KAAK,OACjB,kBAAC,IAAD,CAAeN,KAAK,UAAUO,QA5CX,WACrB,GAnCkB,WAClB,IAAQC,EAA4CvB,EAA5CuB,MAAOC,EAAqCxB,EAArCwB,SAAUC,EAA2BzB,EAA3ByB,SAAUC,EAAiB1B,EAAjB0B,aACnC,QAAQ,GACN,MAAOH,EACL,IAAMI,KAAK,8CACX,MACF,KAAKC,IAASC,KAAKN,GAAS,IAC1B,IAAMI,KAAK,4EACX,MACF,MAAOF,EACL,IAAME,KAAK,wCACX,MACF,KAAKG,IAAYD,KAAKJ,GAAY,IAChC,IAAME,KAAK,sFACX,MACF,MAAOH,EACL,IAAMG,KAAK,8CACX,MACF,KAAKI,IAAOF,KAAKL,GAAY,IAC3B,IAAMG,KAAK,sIACX,MACF,MAAOD,EACL,IAAMC,KAAK,8CACX,MACF,KAAKD,IAAiBF,EAEpB,IAAMG,KAAK,oDACX,MACF,QACE,OAAO,EAEX,OAAO,EAIHK,GAAe,CACjB,IAAQT,EAAoBvB,EAApBuB,MAAOC,EAAaxB,EAAbwB,SAEfjB,EAAY,CACV0B,UAAW,CAAEV,QAAOC,SAAUU,IAAIV,GAAY,IAAIW,iBAuCpD,gBAGA,kBAACtC,EAAD,CACEuC,YAAU,QACVjB,SAAU,SAACkB,MAFb,qBAKE,kBAAC,IAAD,CACEf,QAAS,SAACe,GACRA,EAAEC,iBACFC,MAAM,gDAHV,oDALF,IAcE,kBAAC,IAAD,CACEjB,QAAS,SAACe,GACRA,EAAEC,iBACFC,MAAM,oCAHV","file":"16.c006b9cd.chunk.js","sourcesContent":["import React, { useState } from 'react';\r\nimport { WhiteSpace, InputItem, Checkbox, Toast } from 'antd-mobile';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { useLazyQuery } from '@apollo/client';\r\nimport { USER_RIGISTER } from '@/helpers/APIHelper';\r\nimport md5 from 'crypto-js/md5';\r\nimport { Page, PageTitle, PrimaryButton, OthersItem } from '../styles';\r\nimport { RegisterFormValues } from '../types';\r\nimport { userNameReg, emailReg, pwdReg } from '../regs';\r\n\r\nconst { AgreeItem } = Checkbox;\r\n\r\nconst Register: React.FC = () => {\r\n  const [formValues, setFormValues] = useState<RegisterFormValues>({}); // 表单值\r\n  const [registerReq, { loading }] = useLazyQuery(USER_RIGISTER, {\r\n    onCompleted: (loginRes) => registerSuccess(loginRes),\r\n  });\r\n  const history = useHistory();\r\n  // 登录成功后操作\r\n  const registerSuccess = (data: { _id: string }): void => {\r\n    console.log(data);\r\n    history.goBack();\r\n  };\r\n\r\n  // 表单校验\r\n  const checkValues = (): boolean => {\r\n    const { email, password, userName, surePassword } = formValues;\r\n    switch (false) {\r\n      case !!email:\r\n        Toast.info('请输入电子邮箱');\r\n        break;\r\n      case emailReg.test(email || ''):\r\n        Toast.info('请输入正确的电子邮箱格式');\r\n        break;\r\n      case !!userName:\r\n        Toast.info('请输入用户名');\r\n        break;\r\n      case userNameReg.test(userName || ''):\r\n        Toast.info('请输入由数字字母组成8-24位账号');\r\n        break;\r\n      case !!password:\r\n        Toast.info('请输入账号密码');\r\n        break;\r\n      case pwdReg.test(password || ''):\r\n        Toast.info('请输入8-24位包含大小写字母数字及特殊字符的密码');\r\n        break;\r\n      case !!surePassword:\r\n        Toast.info('请输入确认密码');\r\n        break;\r\n      case surePassword === password:\r\n        console.log(surePassword, password, surePassword !== password);\r\n        Toast.info('请与密码保持一致');\r\n        break;\r\n      default:\r\n        return true;\r\n    }\r\n    return false;\r\n  };\r\n  // 提交注册\r\n  const handleRegister = (): void => {\r\n    if (checkValues()) {\r\n      const { email, password } = formValues;\r\n      console.log({ variables: { email, password } });\r\n      registerReq({\r\n        variables: { email, password: md5(password || '').toString() },\r\n      });\r\n    }\r\n  };\r\n  // 表单值改变\r\n  const handleChange = (value: string, type: string): void => {\r\n    setFormValues((vals) => ({ ...vals, [type]: value }));\r\n  };\r\n\r\n  //\r\n  return (\r\n    <Page>\r\n      <PageTitle>新用户注册</PageTitle>\r\n      <InputItem\r\n        placeholder=\"请输入邮箱\"\r\n        name=\"email\"\r\n        onChange={(val): void => handleChange(val, 'email')}\r\n      />\r\n      <WhiteSpace size=\"lg\" />\r\n      <InputItem\r\n        placeholder=\"请输入用户名\"\r\n        name=\"userName\"\r\n        onChange={(val): void => handleChange(val, 'userName')}\r\n      />\r\n      <WhiteSpace size=\"lg\" />\r\n      <InputItem\r\n        placeholder=\"请输入密码\"\r\n        type=\"password\"\r\n        name=\"password\"\r\n        onChange={(val): void => handleChange(val, 'password')}\r\n      />\r\n      <WhiteSpace size=\"lg\" />\r\n      <InputItem\r\n        placeholder=\"请输入确认密码\"\r\n        type=\"password\"\r\n        name=\"surePassword\"\r\n        onChange={(val): void => handleChange(val, 'surePassword')}\r\n      />\r\n      <WhiteSpace size=\"lg\" />\r\n      <PrimaryButton type=\"primary\" onClick={handleRegister}>\r\n        注册\r\n      </PrimaryButton>\r\n      <AgreeItem\r\n        data-seed=\"logId\"\r\n        onChange={(e: TouchEvent): void => console.log('checkbox', e)}\r\n      >\r\n        我同意\r\n        <OthersItem\r\n          onClick={(e): void => {\r\n            e.preventDefault();\r\n            alert('agree 用户服务协议');\r\n          }}\r\n        >\r\n          《用户服务协议》\r\n        </OthersItem>\r\n        ,\r\n        <OthersItem\r\n          onClick={(e): void => {\r\n            e.preventDefault();\r\n            alert('agree 隐私政策');\r\n          }}\r\n        >\r\n          《隐私政策》\r\n        </OthersItem>\r\n      </AgreeItem>\r\n    </Page>\r\n  );\r\n};\r\n\r\nexport default Register;\r\n"],"sourceRoot":""}