{"version":3,"sources":["pages/UserCenter/utils/exif/index.js","components/TabBar/styles.ts","components/TabBar/TabBar.tsx","pages/Library/Library.tsx","pages/Library/utils/filterArr.ts","pages/UserCenter/images/avatar-default.jpg","pages/Find/styles.ts","pages/Find/images/icon-star2.svg","pages/Find/Ladder/Ladder.tsx","pages/Find/utils/getLevel.ts","pages/Find/Strength/Radar.tsx","pages/Find/Strength/SubjectParsing.tsx","pages/Find/Strength/Strength.tsx","pages/Find/Predict/Predict.tsx","pages/Find/Find.tsx","pages/UserCenter/images/bg.jpg","pages/UserCenter/styles.ts","pages/UserCenter/utils/chooseImg.ts","pages/UserCenter/UserCenter.tsx","pages/Home/Home.tsx"],"names":["debug","EXIF","obj","this","EXIFwrapped","module","exports","ExifTags","Tags","TiffTags","GPSTags","0","IFD1Tags","StringValues","ExposureProgram","1","2","3","4","5","6","7","8","MeteringMode","255","LightSource","9","10","11","12","13","14","15","17","18","19","20","21","22","23","24","Flash","SensingMethod","SceneCaptureType","SceneType","CustomRendered","WhiteBalance","GainControl","Contrast","Saturation","Sharpness","SubjectDistanceRange","FileSource","Components","imageHasData","img","exifdata","getImageData","callback","handleBinaryFile","binFile","data","findEXIFinJPEG","iptcdata","file","dataView","DataView","getUint8","offset","length","byteLength","isFieldSegmentStart","nameHeaderLength","readIPTCData","getUint16","findIPTCinJPEG","isXmpEnabled","xmpdata","self","dom","DOMParser","getStringFromDB","startOffset","sectionLength","xmpString","xmpEndIndex","indexOf","indexOfXmp","substring","slice","xml2Object","parseFromString","findXMPinJPEG","call","src","test","base64","contentType","match","replace","binary","atob","len","buffer","ArrayBuffer","view","Uint8Array","i","charCodeAt","base64ToArrayBuffer","fileReader","FileReader","onload","e","target","result","url","http","XMLHttpRequest","open","responseType","status","response","send","objectURLToBlob","blob","readAsArrayBuffer","Blob","File","readEXIFData","IptcFieldMap","fieldValue","fieldName","dataSize","segmentType","segmentStartPos","getInt16","hasOwnProperty","Array","push","readTags","tiffStart","dirStart","strings","bigEnd","entryOffset","entries","tags","readTagValue","vals","val","n","numerator","denominator","type","numValues","getUint32","valueOffset","Number","getInt32","start","outstr","String","fromCharCode","tag","exifData","gpsData","tiffOffset","firstIFDOffset","ExifIFDPointer","GPSInfoIFDPointer","IFD1OffsetPointer","getNextIFDOffset","thumbTags","JpegIFOffset","JpegIFByteCount","tOffset","tLength","readThumbnailImage","xml2json","xml","json","nodeType","attributes","j","attribute","item","nodeName","nodeValue","hasChildNodes","childNodes","child","old","children","idx","itemAtt","dataKey","dataValue","undefined","textContent","enableXmp","disableXmp","getData","Image","HTMLImageElement","complete","getTag","getIptcTag","getAllTags","a","getAllIptcTags","pretty","strPretty","readFromBinaryFile","themeColor","pkg","theme","TabBarBox","styled","div","BottomBlank","TabBarInner","TabBarItem","ItemIcon","span","ItemTitle","TabBar","props","handelClick","onClick","className","Library","useState","value","label","subjectArr","setSubjectArr","userInfo","useQuery","USER_SHOW","useLazyQuery","QUERY_SUBJECT","subjectReq","sujectData","subjectLoading","loading","SUBJECT_TAGS","subjectTagsReq","subjectTagsData","subjectTagLoading","subjectTags","getUserTagAbilities","subjectExams","getExamHistoryBySubject","filterExam","useMemo","arr","comMap","resultArr","forEach","sourceType","Object","keys","key","filterSourceType","filterExamHis","resultMap","examId","filterExamId","useContext","ProviderContext","state","dispatch","tabType","ejuSubjectValue","history","useHistory","handleTabChange","tabTypeToSourceType","setAbilities","useCallback","prevTag","abilities","startArr","tagId","abilityValue","Math","round","getQuick","map","_id","name","Header","title","Body","item2","name2","_id2","children2","Panel","header","style","marginBottom","item3","name3","_id3","size","inline","subject","handleToExamInfo","exam","getExam","examEnum","examDate","date","dateToYear","bestPoints","examHis","getTopic","useEffect","variables","typeSubjects","stringArrToPickArr","subjectEnum","hide","userData","getUserInfo","avatar","cols","onOk","changeEjuSubject","PickItem","placeholder","Page","TabBox","TabItem","InfoBox","InfoLi","InfoItem","IconStar","SelectBox","SelectBoxItem","Table","table","Tr","tr","Td","td","Th","th","RadarScroll","PredictBox","PredictBoxButton","button","PredictBoxFont","PredictSelect","PredictScroll","LadderBox","LadderContent","RankHeader","ItemFirst","ItemSecond","pl","ItemThird","RankList","RankItem","RankItemCenter","RankItemStart","RankAvatar","prop","RankName","RankItemEnd","RankIcon","SelectItem","IconArrow","Ladder","rankNum","subjectPointsArr","FIND_RANK","fetchPolicy","getRank","findRankData","rankArr","findRank","rankValue","setRankValue","rankData","setRankData","showMy","setShowmy","getSubjectRank","subjectRankThisWeek","initData","param","pointsLabel","getPointsLabel","rankSet","index","rank","userName","point","isHigher","dw","getRankItem","getLevel","level","Radar","subjectPoint","score","width","window","screen","chart","F2","Chart","id","pixelRatio","devicePixelRatio","padding","height","coord","source","values","axis","text","total","top","grid","line","area","position","color","animate","appear","animation","stroke","lineWidth","delay","legend","custom","items","marker","fill","render","tableListData","getTabelData","SubjectParsing","pointsData","setPointData","pointsValue","setPointValue","subjectvalue","setSubjectValue","SUBJECT_TAGS_ONLY","getTags","tagsLoading","FIND_TAG","onCompleted","res","handleAbility","getAbilityTag","tagsArrRef","useRef","chartRef","findAbilityTag","abilityValues","tagName","showParsing","tagsData","tagsArr","current","appendPadding","scale","ticks","getLabelFromValue","Strength","handleStrengthTabChang","strengthTab","tabs","sub","page","onChange","tab","Predict","school","setSchool","totalData","setTotalData","goalSchool","setGoalSchool","ejuSubject","setEjuSubject","department","setDepartment","probability","setProbability","english","jap","jap_writing","math","physics","chemistry","recommendPoint","setRecommendPoint","recommendPointData","verticalAlign","APIHelper","getSchool","then","filterArr","getGoalSchool","getSubject","departments","handleSchool","schoolName","toFixed","school_id","ja","phy","che","jaw","predict","code","ability","handlePredict","sourceData","goalPoint","goalLevel","itemData","Find","FIND_GENERAL_ABILITY","generalAbility","findSujectData","FIND_SUBJECT","predicterPoints","PREDICTED_POINTS","findPredictedPoints","totalRankThisWeek","findPointsSubject","totalPoint","findSubjectArr","findSubjects","findGeneralAbility","setTabType","setRankNum","subjectFilterArr","setSubjectFilterArr","findSubjectFilterArr","setFindSubjectFilterArr","setStrengthTab","getTabContent","ele","nickName","getStar","starArr","getInfo","Item1","Item2","Item3","Item4","PersonBg","PersonInner","PersonBgInner","bg","AvatarBox","Avatar","AvatarUpload","input","NickBox","NickName","Sign","FucList","FucListItem","FucListItemTop","FucListItemBottom","MenuBox","MenuItem","MenuLabel","MenuIcon","MsgNum","compressImg","imgBase64","sizeNum","Promise","resolve","reject","canvas","document","createElement","context","getContext","onerror","Error","w","h","orient","getPhotoOrientation","save","translate","rotate","PI","drawImage","restore","imgCompressed","toDataURL","chooseImg","checkImg","reader","readAsDataURL","imageBase64","catch","pressError","UserCenter","msgNum","QUERY_MSG_NUM","signature","avatarBase64","setAvatarBase64","useMutation","UPDATE_USER_INFO","onError","updateUserInfo","avatarStr","avatarDefault","handleMenu","accept","fileData","files","getElementById","offsetWidth","userInfoInput","getImg","getUnreadMessageCount","Home","setType","location","useLocation","pathname","handleClick","clickType"],"mappings":"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","file":"2.2386fc8d.chunk.js","sourcesContent":["/* eslint-disable */\r\n(function () {\r\n  var debug = false;\r\n\r\n  var root = this;\r\n\r\n  var EXIF = function (obj) {\r\n    if (obj instanceof EXIF) return obj;\r\n    if (!(this instanceof EXIF)) return new EXIF(obj);\r\n    this.EXIFwrapped = obj;\r\n  };\r\n\r\n  if (typeof exports !== 'undefined') {\r\n    if (typeof module !== 'undefined' && module.exports) {\r\n      exports = module.exports = EXIF;\r\n    }\r\n    exports.EXIF = EXIF;\r\n  } else {\r\n    root.EXIF = EXIF;\r\n  }\r\n\r\n  var ExifTags = (EXIF.Tags = {\r\n    // version tags\r\n    0x9000: 'ExifVersion', // EXIF version\r\n    0xa000: 'FlashpixVersion', // Flashpix format version\r\n\r\n    // colorspace tags\r\n    0xa001: 'ColorSpace', // Color space information tag\r\n\r\n    // image configuration\r\n    0xa002: 'PixelXDimension', // Valid width of meaningful image\r\n    0xa003: 'PixelYDimension', // Valid height of meaningful image\r\n    0x9101: 'ComponentsConfiguration', // Information about channels\r\n    0x9102: 'CompressedBitsPerPixel', // Compressed bits per pixel\r\n\r\n    // user information\r\n    0x927c: 'MakerNote', // Any desired information written by the manufacturer\r\n    0x9286: 'UserComment', // Comments by user\r\n\r\n    // related file\r\n    0xa004: 'RelatedSoundFile', // Name of related sound file\r\n\r\n    // date and time\r\n    0x9003: 'DateTimeOriginal', // Date and time when the original image was generated\r\n    0x9004: 'DateTimeDigitized', // Date and time when the image was stored digitally\r\n    0x9290: 'SubsecTime', // Fractions of seconds for DateTime\r\n    0x9291: 'SubsecTimeOriginal', // Fractions of seconds for DateTimeOriginal\r\n    0x9292: 'SubsecTimeDigitized', // Fractions of seconds for DateTimeDigitized\r\n\r\n    // picture-taking conditions\r\n    0x829a: 'ExposureTime', // Exposure time (in seconds)\r\n    0x829d: 'FNumber', // F number\r\n    0x8822: 'ExposureProgram', // Exposure program\r\n    0x8824: 'SpectralSensitivity', // Spectral sensitivity\r\n    0x8827: 'ISOSpeedRatings', // ISO speed rating\r\n    0x8828: 'OECF', // Optoelectric conversion factor\r\n    0x9201: 'ShutterSpeedValue', // Shutter speed\r\n    0x9202: 'ApertureValue', // Lens aperture\r\n    0x9203: 'BrightnessValue', // Value of brightness\r\n    0x9204: 'ExposureBias', // Exposure bias\r\n    0x9205: 'MaxApertureValue', // Smallest F number of lens\r\n    0x9206: 'SubjectDistance', // Distance to subject in meters\r\n    0x9207: 'MeteringMode', // Metering mode\r\n    0x9208: 'LightSource', // Kind of light source\r\n    0x9209: 'Flash', // Flash status\r\n    0x9214: 'SubjectArea', // Location and area of main subject\r\n    0x920a: 'FocalLength', // Focal length of the lens in mm\r\n    0xa20b: 'FlashEnergy', // Strobe energy in BCPS\r\n    0xa20c: 'SpatialFrequencyResponse', //\r\n    0xa20e: 'FocalPlaneXResolution', // Number of pixels in width direction per FocalPlaneResolutionUnit\r\n    0xa20f: 'FocalPlaneYResolution', // Number of pixels in height direction per FocalPlaneResolutionUnit\r\n    0xa210: 'FocalPlaneResolutionUnit', // Unit for measuring FocalPlaneXResolution and FocalPlaneYResolution\r\n    0xa214: 'SubjectLocation', // Location of subject in image\r\n    0xa215: 'ExposureIndex', // Exposure index selected on camera\r\n    0xa217: 'SensingMethod', // Image sensor type\r\n    0xa300: 'FileSource', // Image source (3 == DSC)\r\n    0xa301: 'SceneType', // Scene type (1 == directly photographed)\r\n    0xa302: 'CFAPattern', // Color filter array geometric pattern\r\n    0xa401: 'CustomRendered', // Special processing\r\n    0xa402: 'ExposureMode', // Exposure mode\r\n    0xa403: 'WhiteBalance', // 1 = auto white balance, 2 = manual\r\n    0xa404: 'DigitalZoomRation', // Digital zoom ratio\r\n    0xa405: 'FocalLengthIn35mmFilm', // Equivalent foacl length assuming 35mm film camera (in mm)\r\n    0xa406: 'SceneCaptureType', // Type of scene\r\n    0xa407: 'GainControl', // Degree of overall image gain adjustment\r\n    0xa408: 'Contrast', // Direction of contrast processing applied by camera\r\n    0xa409: 'Saturation', // Direction of saturation processing applied by camera\r\n    0xa40a: 'Sharpness', // Direction of sharpness processing applied by camera\r\n    0xa40b: 'DeviceSettingDescription', //\r\n    0xa40c: 'SubjectDistanceRange', // Distance to subject\r\n\r\n    // other tags\r\n    0xa005: 'InteroperabilityIFDPointer',\r\n    0xa420: 'ImageUniqueID', // Identifier assigned uniquely to each image\r\n  });\r\n\r\n  var TiffTags = (EXIF.TiffTags = {\r\n    0x0100: 'ImageWidth',\r\n    0x0101: 'ImageHeight',\r\n    0x8769: 'ExifIFDPointer',\r\n    0x8825: 'GPSInfoIFDPointer',\r\n    0xa005: 'InteroperabilityIFDPointer',\r\n    0x0102: 'BitsPerSample',\r\n    0x0103: 'Compression',\r\n    0x0106: 'PhotometricInterpretation',\r\n    0x0112: 'Orientation',\r\n    0x0115: 'SamplesPerPixel',\r\n    0x011c: 'PlanarConfiguration',\r\n    0x0212: 'YCbCrSubSampling',\r\n    0x0213: 'YCbCrPositioning',\r\n    0x011a: 'XResolution',\r\n    0x011b: 'YResolution',\r\n    0x0128: 'ResolutionUnit',\r\n    0x0111: 'StripOffsets',\r\n    0x0116: 'RowsPerStrip',\r\n    0x0117: 'StripByteCounts',\r\n    0x0201: 'JPEGInterchangeFormat',\r\n    0x0202: 'JPEGInterchangeFormatLength',\r\n    0x012d: 'TransferFunction',\r\n    0x013e: 'WhitePoint',\r\n    0x013f: 'PrimaryChromaticities',\r\n    0x0211: 'YCbCrCoefficients',\r\n    0x0214: 'ReferenceBlackWhite',\r\n    0x0132: 'DateTime',\r\n    0x010e: 'ImageDescription',\r\n    0x010f: 'Make',\r\n    0x0110: 'Model',\r\n    0x0131: 'Software',\r\n    0x013b: 'Artist',\r\n    0x8298: 'Copyright',\r\n  });\r\n\r\n  var GPSTags = (EXIF.GPSTags = {\r\n    0x0000: 'GPSVersionID',\r\n    0x0001: 'GPSLatitudeRef',\r\n    0x0002: 'GPSLatitude',\r\n    0x0003: 'GPSLongitudeRef',\r\n    0x0004: 'GPSLongitude',\r\n    0x0005: 'GPSAltitudeRef',\r\n    0x0006: 'GPSAltitude',\r\n    0x0007: 'GPSTimeStamp',\r\n    0x0008: 'GPSSatellites',\r\n    0x0009: 'GPSStatus',\r\n    0x000a: 'GPSMeasureMode',\r\n    0x000b: 'GPSDOP',\r\n    0x000c: 'GPSSpeedRef',\r\n    0x000d: 'GPSSpeed',\r\n    0x000e: 'GPSTrackRef',\r\n    0x000f: 'GPSTrack',\r\n    0x0010: 'GPSImgDirectionRef',\r\n    0x0011: 'GPSImgDirection',\r\n    0x0012: 'GPSMapDatum',\r\n    0x0013: 'GPSDestLatitudeRef',\r\n    0x0014: 'GPSDestLatitude',\r\n    0x0015: 'GPSDestLongitudeRef',\r\n    0x0016: 'GPSDestLongitude',\r\n    0x0017: 'GPSDestBearingRef',\r\n    0x0018: 'GPSDestBearing',\r\n    0x0019: 'GPSDestDistanceRef',\r\n    0x001a: 'GPSDestDistance',\r\n    0x001b: 'GPSProcessingMethod',\r\n    0x001c: 'GPSAreaInformation',\r\n    0x001d: 'GPSDateStamp',\r\n    0x001e: 'GPSDifferential',\r\n  });\r\n\r\n  // EXIF 2.3 Spec\r\n  var IFD1Tags = (EXIF.IFD1Tags = {\r\n    0x0100: 'ImageWidth',\r\n    0x0101: 'ImageHeight',\r\n    0x0102: 'BitsPerSample',\r\n    0x0103: 'Compression',\r\n    0x0106: 'PhotometricInterpretation',\r\n    0x0111: 'StripOffsets',\r\n    0x0112: 'Orientation',\r\n    0x0115: 'SamplesPerPixel',\r\n    0x0116: 'RowsPerStrip',\r\n    0x0117: 'StripByteCounts',\r\n    0x011a: 'XResolution',\r\n    0x011b: 'YResolution',\r\n    0x011c: 'PlanarConfiguration',\r\n    0x0128: 'ResolutionUnit',\r\n    0x0201: 'JpegIFOffset', // When image format is JPEG, this value show offset to JPEG data stored.(aka \"ThumbnailOffset\" or \"JPEGInterchangeFormat\")\r\n    0x0202: 'JpegIFByteCount', // When image format is JPEG, this value shows data size of JPEG image (aka \"ThumbnailLength\" or \"JPEGInterchangeFormatLength\")\r\n    0x0211: 'YCbCrCoefficients',\r\n    0x0212: 'YCbCrSubSampling',\r\n    0x0213: 'YCbCrPositioning',\r\n    0x0214: 'ReferenceBlackWhite',\r\n  });\r\n\r\n  var StringValues = (EXIF.StringValues = {\r\n    ExposureProgram: {\r\n      0: 'Not defined',\r\n      1: 'Manual',\r\n      2: 'Normal program',\r\n      3: 'Aperture priority',\r\n      4: 'Shutter priority',\r\n      5: 'Creative program',\r\n      6: 'Action program',\r\n      7: 'Portrait mode',\r\n      8: 'Landscape mode',\r\n    },\r\n    MeteringMode: {\r\n      0: 'Unknown',\r\n      1: 'Average',\r\n      2: 'CenterWeightedAverage',\r\n      3: 'Spot',\r\n      4: 'MultiSpot',\r\n      5: 'Pattern',\r\n      6: 'Partial',\r\n      255: 'Other',\r\n    },\r\n    LightSource: {\r\n      0: 'Unknown',\r\n      1: 'Daylight',\r\n      2: 'Fluorescent',\r\n      3: 'Tungsten (incandescent light)',\r\n      4: 'Flash',\r\n      9: 'Fine weather',\r\n      10: 'Cloudy weather',\r\n      11: 'Shade',\r\n      12: 'Daylight fluorescent (D 5700 - 7100K)',\r\n      13: 'Day white fluorescent (N 4600 - 5400K)',\r\n      14: 'Cool white fluorescent (W 3900 - 4500K)',\r\n      15: 'White fluorescent (WW 3200 - 3700K)',\r\n      17: 'Standard light A',\r\n      18: 'Standard light B',\r\n      19: 'Standard light C',\r\n      20: 'D55',\r\n      21: 'D65',\r\n      22: 'D75',\r\n      23: 'D50',\r\n      24: 'ISO studio tungsten',\r\n      255: 'Other',\r\n    },\r\n    Flash: {\r\n      0x0000: 'Flash did not fire',\r\n      0x0001: 'Flash fired',\r\n      0x0005: 'Strobe return light not detected',\r\n      0x0007: 'Strobe return light detected',\r\n      0x0009: 'Flash fired, compulsory flash mode',\r\n      0x000d: 'Flash fired, compulsory flash mode, return light not detected',\r\n      0x000f: 'Flash fired, compulsory flash mode, return light detected',\r\n      0x0010: 'Flash did not fire, compulsory flash mode',\r\n      0x0018: 'Flash did not fire, auto mode',\r\n      0x0019: 'Flash fired, auto mode',\r\n      0x001d: 'Flash fired, auto mode, return light not detected',\r\n      0x001f: 'Flash fired, auto mode, return light detected',\r\n      0x0020: 'No flash function',\r\n      0x0041: 'Flash fired, red-eye reduction mode',\r\n      0x0045: 'Flash fired, red-eye reduction mode, return light not detected',\r\n      0x0047: 'Flash fired, red-eye reduction mode, return light detected',\r\n      0x0049: 'Flash fired, compulsory flash mode, red-eye reduction mode',\r\n      0x004d:\r\n        'Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected',\r\n      0x004f:\r\n        'Flash fired, compulsory flash mode, red-eye reduction mode, return light detected',\r\n      0x0059: 'Flash fired, auto mode, red-eye reduction mode',\r\n      0x005d:\r\n        'Flash fired, auto mode, return light not detected, red-eye reduction mode',\r\n      0x005f:\r\n        'Flash fired, auto mode, return light detected, red-eye reduction mode',\r\n    },\r\n    SensingMethod: {\r\n      1: 'Not defined',\r\n      2: 'One-chip color area sensor',\r\n      3: 'Two-chip color area sensor',\r\n      4: 'Three-chip color area sensor',\r\n      5: 'Color sequential area sensor',\r\n      7: 'Trilinear sensor',\r\n      8: 'Color sequential linear sensor',\r\n    },\r\n    SceneCaptureType: {\r\n      0: 'Standard',\r\n      1: 'Landscape',\r\n      2: 'Portrait',\r\n      3: 'Night scene',\r\n    },\r\n    SceneType: {\r\n      1: 'Directly photographed',\r\n    },\r\n    CustomRendered: {\r\n      0: 'Normal process',\r\n      1: 'Custom process',\r\n    },\r\n    WhiteBalance: {\r\n      0: 'Auto white balance',\r\n      1: 'Manual white balance',\r\n    },\r\n    GainControl: {\r\n      0: 'None',\r\n      1: 'Low gain up',\r\n      2: 'High gain up',\r\n      3: 'Low gain down',\r\n      4: 'High gain down',\r\n    },\r\n    Contrast: {\r\n      0: 'Normal',\r\n      1: 'Soft',\r\n      2: 'Hard',\r\n    },\r\n    Saturation: {\r\n      0: 'Normal',\r\n      1: 'Low saturation',\r\n      2: 'High saturation',\r\n    },\r\n    Sharpness: {\r\n      0: 'Normal',\r\n      1: 'Soft',\r\n      2: 'Hard',\r\n    },\r\n    SubjectDistanceRange: {\r\n      0: 'Unknown',\r\n      1: 'Macro',\r\n      2: 'Close view',\r\n      3: 'Distant view',\r\n    },\r\n    FileSource: {\r\n      3: 'DSC',\r\n    },\r\n\r\n    Components: {\r\n      0: '',\r\n      1: 'Y',\r\n      2: 'Cb',\r\n      3: 'Cr',\r\n      4: 'R',\r\n      5: 'G',\r\n      6: 'B',\r\n    },\r\n  });\r\n\r\n  function addEvent(element, event, handler) {\r\n    if (element.addEventListener) {\r\n      element.addEventListener(event, handler, false);\r\n    } else if (element.attachEvent) {\r\n      element.attachEvent('on' + event, handler);\r\n    }\r\n  }\r\n\r\n  function imageHasData(img) {\r\n    return !!img.exifdata;\r\n  }\r\n\r\n  function base64ToArrayBuffer(base64, contentType) {\r\n    contentType =\r\n      contentType || base64.match(/^data\\:([^\\;]+)\\;base64,/im)[1] || ''; // e.g. 'data:image/jpeg;base64,...' => 'image/jpeg'\r\n    base64 = base64.replace(/^data\\:([^\\;]+)\\;base64,/gim, '');\r\n    var binary = atob(base64);\r\n    var len = binary.length;\r\n    var buffer = new ArrayBuffer(len);\r\n    var view = new Uint8Array(buffer);\r\n    for (var i = 0; i < len; i++) {\r\n      view[i] = binary.charCodeAt(i);\r\n    }\r\n    return buffer;\r\n  }\r\n\r\n  function objectURLToBlob(url, callback) {\r\n    var http = new XMLHttpRequest();\r\n    http.open('GET', url, true);\r\n    http.responseType = 'blob';\r\n    http.onload = function (e) {\r\n      if (this.status == 200 || this.status === 0) {\r\n        callback(this.response);\r\n      }\r\n    };\r\n    http.send();\r\n  }\r\n\r\n  function getImageData(img, callback) {\r\n    function handleBinaryFile(binFile) {\r\n      var data = findEXIFinJPEG(binFile);\r\n      img.exifdata = data || {};\r\n      var iptcdata = findIPTCinJPEG(binFile);\r\n      img.iptcdata = iptcdata || {};\r\n      if (EXIF.isXmpEnabled) {\r\n        var xmpdata = findXMPinJPEG(binFile);\r\n        img.xmpdata = xmpdata || {};\r\n      }\r\n      if (callback) {\r\n        callback.call(img);\r\n      }\r\n    }\r\n\r\n    if (img.src) {\r\n      if (/^data\\:/i.test(img.src)) {\r\n        // Data URI\r\n        var arrayBuffer = base64ToArrayBuffer(img.src);\r\n        handleBinaryFile(arrayBuffer);\r\n      } else if (/^blob\\:/i.test(img.src)) {\r\n        // Object URL\r\n        var fileReader = new FileReader();\r\n        fileReader.onload = function (e) {\r\n          handleBinaryFile(e.target.result);\r\n        };\r\n        objectURLToBlob(img.src, function (blob) {\r\n          fileReader.readAsArrayBuffer(blob);\r\n        });\r\n      } else {\r\n        var http = new XMLHttpRequest();\r\n        http.onload = function () {\r\n          if (this.status == 200 || this.status === 0) {\r\n            handleBinaryFile(http.response);\r\n          } else {\r\n            throw 'Could not load image';\r\n          }\r\n          http = null;\r\n        };\r\n        http.open('GET', img.src, true);\r\n        http.responseType = 'arraybuffer';\r\n        http.send(null);\r\n      }\r\n    } else if (\r\n      self.FileReader &&\r\n      (img instanceof self.Blob || img instanceof self.File)\r\n    ) {\r\n      var fileReader = new FileReader();\r\n      fileReader.onload = function (e) {\r\n        if (debug)\r\n          console.log('Got file of length ' + e.target.result.byteLength);\r\n        handleBinaryFile(e.target.result);\r\n      };\r\n\r\n      fileReader.readAsArrayBuffer(img);\r\n    }\r\n  }\r\n\r\n  function findEXIFinJPEG(file) {\r\n    var dataView = new DataView(file);\r\n\r\n    if (debug) console.log('Got file of length ' + file.byteLength);\r\n    if (dataView.getUint8(0) != 0xff || dataView.getUint8(1) != 0xd8) {\r\n      if (debug) console.log('Not a valid JPEG');\r\n      return false; // not a valid jpeg\r\n    }\r\n\r\n    var offset = 2,\r\n      length = file.byteLength,\r\n      marker;\r\n\r\n    while (offset < length) {\r\n      if (dataView.getUint8(offset) != 0xff) {\r\n        if (debug)\r\n          console.log(\r\n            'Not a valid marker at offset ' +\r\n              offset +\r\n              ', found: ' +\r\n              dataView.getUint8(offset)\r\n          );\r\n        return false; // not a valid marker, something is wrong\r\n      }\r\n\r\n      marker = dataView.getUint8(offset + 1);\r\n      if (debug) console.log(marker);\r\n\r\n      // we could implement handling for other markers here,\r\n      // but we're only looking for 0xFFE1 for EXIF data\r\n\r\n      if (marker == 225) {\r\n        if (debug) console.log('Found 0xFFE1 marker');\r\n\r\n        return readEXIFData(\r\n          dataView,\r\n          offset + 4,\r\n          dataView.getUint16(offset + 2) - 2\r\n        );\r\n\r\n        // offset += 2 + file.getShortAt(offset+2, true);\r\n      } else {\r\n        offset += 2 + dataView.getUint16(offset + 2);\r\n      }\r\n    }\r\n  }\r\n\r\n  function findIPTCinJPEG(file) {\r\n    var dataView = new DataView(file);\r\n\r\n    if (debug) console.log('Got file of length ' + file.byteLength);\r\n    if (dataView.getUint8(0) != 0xff || dataView.getUint8(1) != 0xd8) {\r\n      if (debug) console.log('Not a valid JPEG');\r\n      return false; // not a valid jpeg\r\n    }\r\n\r\n    var offset = 2,\r\n      length = file.byteLength;\r\n\r\n    var isFieldSegmentStart = function (dataView, offset) {\r\n      return (\r\n        dataView.getUint8(offset) === 0x38 &&\r\n        dataView.getUint8(offset + 1) === 0x42 &&\r\n        dataView.getUint8(offset + 2) === 0x49 &&\r\n        dataView.getUint8(offset + 3) === 0x4d &&\r\n        dataView.getUint8(offset + 4) === 0x04 &&\r\n        dataView.getUint8(offset + 5) === 0x04\r\n      );\r\n    };\r\n\r\n    while (offset < length) {\r\n      if (isFieldSegmentStart(dataView, offset)) {\r\n        // Get the length of the name header (which is padded to an even number of bytes)\r\n        var nameHeaderLength = dataView.getUint8(offset + 7);\r\n        if (nameHeaderLength % 2 !== 0) nameHeaderLength += 1;\r\n        // Check for pre photoshop 6 format\r\n        if (nameHeaderLength === 0) {\r\n          // Always 4\r\n          nameHeaderLength = 4;\r\n        }\r\n\r\n        var startOffset = offset + 8 + nameHeaderLength;\r\n        var sectionLength = dataView.getUint16(offset + 6 + nameHeaderLength);\r\n\r\n        return readIPTCData(file, startOffset, sectionLength);\r\n\r\n        break;\r\n      }\r\n\r\n      // Not the marker, continue searching\r\n      offset++;\r\n    }\r\n  }\r\n  var IptcFieldMap = {\r\n    0x78: 'caption',\r\n    0x6e: 'credit',\r\n    0x19: 'keywords',\r\n    0x37: 'dateCreated',\r\n    0x50: 'byline',\r\n    0x55: 'bylineTitle',\r\n    0x7a: 'captionWriter',\r\n    0x69: 'headline',\r\n    0x74: 'copyright',\r\n    0x0f: 'category',\r\n  };\r\n  function readIPTCData(file, startOffset, sectionLength) {\r\n    var dataView = new DataView(file);\r\n    var data = {};\r\n    var fieldValue, fieldName, dataSize, segmentType, segmentSize;\r\n    var segmentStartPos = startOffset;\r\n    while (segmentStartPos < startOffset + sectionLength) {\r\n      if (\r\n        dataView.getUint8(segmentStartPos) === 0x1c &&\r\n        dataView.getUint8(segmentStartPos + 1) === 0x02\r\n      ) {\r\n        segmentType = dataView.getUint8(segmentStartPos + 2);\r\n        if (segmentType in IptcFieldMap) {\r\n          dataSize = dataView.getInt16(segmentStartPos + 3);\r\n          segmentSize = dataSize + 5;\r\n          fieldName = IptcFieldMap[segmentType];\r\n          fieldValue = getStringFromDB(dataView, segmentStartPos + 5, dataSize);\r\n          // Check if we already stored a value with this name\r\n          if (data.hasOwnProperty(fieldName)) {\r\n            // Value already stored with this name, create multivalue field\r\n            if (data[fieldName] instanceof Array) {\r\n              data[fieldName].push(fieldValue);\r\n            } else {\r\n              data[fieldName] = [data[fieldName], fieldValue];\r\n            }\r\n          } else {\r\n            data[fieldName] = fieldValue;\r\n          }\r\n        }\r\n      }\r\n      segmentStartPos++;\r\n    }\r\n    return data;\r\n  }\r\n\r\n  function readTags(file, tiffStart, dirStart, strings, bigEnd) {\r\n    var entries = file.getUint16(dirStart, !bigEnd),\r\n      tags = {},\r\n      entryOffset,\r\n      tag,\r\n      i;\r\n\r\n    for (i = 0; i < entries; i++) {\r\n      entryOffset = dirStart + i * 12 + 2;\r\n      tag = strings[file.getUint16(entryOffset, !bigEnd)];\r\n      if (!tag && debug)\r\n        console.log('Unknown tag: ' + file.getUint16(entryOffset, !bigEnd));\r\n      tags[tag] = readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd);\r\n    }\r\n    return tags;\r\n  }\r\n\r\n  function readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd) {\r\n    var type = file.getUint16(entryOffset + 2, !bigEnd),\r\n      numValues = file.getUint32(entryOffset + 4, !bigEnd),\r\n      valueOffset = file.getUint32(entryOffset + 8, !bigEnd) + tiffStart,\r\n      offset,\r\n      vals,\r\n      val,\r\n      n,\r\n      numerator,\r\n      denominator;\r\n\r\n    switch (type) {\r\n      case 1: // byte, 8-bit unsigned int\r\n      case 7: // undefined, 8-bit byte, value depending on field\r\n        if (numValues == 1) {\r\n          return file.getUint8(entryOffset + 8, !bigEnd);\r\n        } else {\r\n          offset = numValues > 4 ? valueOffset : entryOffset + 8;\r\n          vals = [];\r\n          for (n = 0; n < numValues; n++) {\r\n            vals[n] = file.getUint8(offset + n);\r\n          }\r\n          return vals;\r\n        }\r\n\r\n      case 2: // ascii, 8-bit byte\r\n        offset = numValues > 4 ? valueOffset : entryOffset + 8;\r\n        return getStringFromDB(file, offset, numValues - 1);\r\n\r\n      case 3: // short, 16 bit int\r\n        if (numValues == 1) {\r\n          return file.getUint16(entryOffset + 8, !bigEnd);\r\n        } else {\r\n          offset = numValues > 2 ? valueOffset : entryOffset + 8;\r\n          vals = [];\r\n          for (n = 0; n < numValues; n++) {\r\n            vals[n] = file.getUint16(offset + 2 * n, !bigEnd);\r\n          }\r\n          return vals;\r\n        }\r\n\r\n      case 4: // long, 32 bit int\r\n        if (numValues == 1) {\r\n          return file.getUint32(entryOffset + 8, !bigEnd);\r\n        } else {\r\n          vals = [];\r\n          for (n = 0; n < numValues; n++) {\r\n            vals[n] = file.getUint32(valueOffset + 4 * n, !bigEnd);\r\n          }\r\n          return vals;\r\n        }\r\n\r\n      case 5: // rational = two long values, first is numerator, second is denominator\r\n        if (numValues == 1) {\r\n          numerator = file.getUint32(valueOffset, !bigEnd);\r\n          denominator = file.getUint32(valueOffset + 4, !bigEnd);\r\n          val = new Number(numerator / denominator);\r\n          val.numerator = numerator;\r\n          val.denominator = denominator;\r\n          return val;\r\n        } else {\r\n          vals = [];\r\n          for (n = 0; n < numValues; n++) {\r\n            numerator = file.getUint32(valueOffset + 8 * n, !bigEnd);\r\n            denominator = file.getUint32(valueOffset + 4 + 8 * n, !bigEnd);\r\n            vals[n] = new Number(numerator / denominator);\r\n            vals[n].numerator = numerator;\r\n            vals[n].denominator = denominator;\r\n          }\r\n          return vals;\r\n        }\r\n\r\n      case 9: // slong, 32 bit signed int\r\n        if (numValues == 1) {\r\n          return file.getInt32(entryOffset + 8, !bigEnd);\r\n        } else {\r\n          vals = [];\r\n          for (n = 0; n < numValues; n++) {\r\n            vals[n] = file.getInt32(valueOffset + 4 * n, !bigEnd);\r\n          }\r\n          return vals;\r\n        }\r\n\r\n      case 10: // signed rational, two slongs, first is numerator, second is denominator\r\n        if (numValues == 1) {\r\n          return (\r\n            file.getInt32(valueOffset, !bigEnd) /\r\n            file.getInt32(valueOffset + 4, !bigEnd)\r\n          );\r\n        } else {\r\n          vals = [];\r\n          for (n = 0; n < numValues; n++) {\r\n            vals[n] =\r\n              file.getInt32(valueOffset + 8 * n, !bigEnd) /\r\n              file.getInt32(valueOffset + 4 + 8 * n, !bigEnd);\r\n          }\r\n          return vals;\r\n        }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Given an IFD (Image File Directory) start offset\r\n   * returns an offset to next IFD or 0 if it's the last IFD.\r\n   */\r\n  function getNextIFDOffset(dataView, dirStart, bigEnd) {\r\n    //the first 2bytes means the number of directory entries contains in this IFD\r\n    var entries = dataView.getUint16(dirStart, !bigEnd);\r\n\r\n    // After last directory entry, there is a 4bytes of data,\r\n    // it means an offset to next IFD.\r\n    // If its value is '0x00000000', it means this is the last IFD and there is no linked IFD.\r\n\r\n    return dataView.getUint32(dirStart + 2 + entries * 12, !bigEnd); // each entry is 12 bytes long\r\n  }\r\n\r\n  function readThumbnailImage(dataView, tiffStart, firstIFDOffset, bigEnd) {\r\n    // get the IFD1 offset\r\n    var IFD1OffsetPointer = getNextIFDOffset(\r\n      dataView,\r\n      tiffStart + firstIFDOffset,\r\n      bigEnd\r\n    );\r\n\r\n    if (!IFD1OffsetPointer) {\r\n      // console.log('******** IFD1Offset is empty, image thumb not found ********');\r\n      return {};\r\n    } else if (IFD1OffsetPointer > dataView.byteLength) {\r\n      // this should not happen\r\n      // console.log('******** IFD1Offset is outside the bounds of the DataView ********');\r\n      return {};\r\n    }\r\n    // console.log('*******  thumbnail IFD offset (IFD1) is: %s', IFD1OffsetPointer);\r\n\r\n    var thumbTags = readTags(\r\n      dataView,\r\n      tiffStart,\r\n      tiffStart + IFD1OffsetPointer,\r\n      IFD1Tags,\r\n      bigEnd\r\n    );\r\n\r\n    // EXIF 2.3 specification for JPEG format thumbnail\r\n\r\n    // If the value of Compression(0x0103) Tag in IFD1 is '6', thumbnail image format is JPEG.\r\n    // Most of Exif image uses JPEG format for thumbnail. In that case, you can get offset of thumbnail\r\n    // by JpegIFOffset(0x0201) Tag in IFD1, size of thumbnail by JpegIFByteCount(0x0202) Tag.\r\n    // Data format is ordinary JPEG format, starts from 0xFFD8 and ends by 0xFFD9. It seems that\r\n    // JPEG format and 160x120pixels of size are recommended thumbnail format for Exif2.1 or later.\r\n\r\n    if (thumbTags['Compression']) {\r\n      // console.log('Thumbnail image found!');\r\n\r\n      switch (thumbTags['Compression']) {\r\n        case 6:\r\n          // console.log('Thumbnail image format is JPEG');\r\n          if (thumbTags.JpegIFOffset && thumbTags.JpegIFByteCount) {\r\n            // extract the thumbnail\r\n            var tOffset = tiffStart + thumbTags.JpegIFOffset;\r\n            var tLength = thumbTags.JpegIFByteCount;\r\n            thumbTags['blob'] = new Blob(\r\n              [new Uint8Array(dataView.buffer, tOffset, tLength)],\r\n              {\r\n                type: 'image/jpeg',\r\n              }\r\n            );\r\n          }\r\n          break;\r\n\r\n        case 1:\r\n          console.log(\r\n            'Thumbnail image format is TIFF, which is not implemented.'\r\n          );\r\n          break;\r\n        default:\r\n          console.log(\r\n            \"Unknown thumbnail image format '%s'\",\r\n            thumbTags['Compression']\r\n          );\r\n      }\r\n    } else if (thumbTags['PhotometricInterpretation'] == 2) {\r\n      console.log('Thumbnail image format is RGB, which is not implemented.');\r\n    }\r\n    return thumbTags;\r\n  }\r\n\r\n  function getStringFromDB(buffer, start, length) {\r\n    var outstr = '';\r\n    for (var n = start; n < start + length; n++) {\r\n      outstr += String.fromCharCode(buffer.getUint8(n));\r\n    }\r\n    return outstr;\r\n  }\r\n\r\n  function readEXIFData(file, start) {\r\n    if (getStringFromDB(file, start, 4) != 'Exif') {\r\n      if (debug)\r\n        console.log('Not valid EXIF data! ' + getStringFromDB(file, start, 4));\r\n      return false;\r\n    }\r\n\r\n    var bigEnd,\r\n      tags,\r\n      tag,\r\n      exifData,\r\n      gpsData,\r\n      tiffOffset = start + 6;\r\n\r\n    // test for TIFF validity and endianness\r\n    if (file.getUint16(tiffOffset) == 0x4949) {\r\n      bigEnd = false;\r\n    } else if (file.getUint16(tiffOffset) == 0x4d4d) {\r\n      bigEnd = true;\r\n    } else {\r\n      if (debug) console.log('Not valid TIFF data! (no 0x4949 or 0x4D4D)');\r\n      return false;\r\n    }\r\n\r\n    if (file.getUint16(tiffOffset + 2, !bigEnd) != 0x002a) {\r\n      if (debug) console.log('Not valid TIFF data! (no 0x002A)');\r\n      return false;\r\n    }\r\n\r\n    var firstIFDOffset = file.getUint32(tiffOffset + 4, !bigEnd);\r\n\r\n    if (firstIFDOffset < 0x00000008) {\r\n      if (debug)\r\n        console.log(\r\n          'Not valid TIFF data! (First offset less than 8)',\r\n          file.getUint32(tiffOffset + 4, !bigEnd)\r\n        );\r\n      return false;\r\n    }\r\n\r\n    tags = readTags(\r\n      file,\r\n      tiffOffset,\r\n      tiffOffset + firstIFDOffset,\r\n      TiffTags,\r\n      bigEnd\r\n    );\r\n\r\n    if (tags.ExifIFDPointer) {\r\n      exifData = readTags(\r\n        file,\r\n        tiffOffset,\r\n        tiffOffset + tags.ExifIFDPointer,\r\n        ExifTags,\r\n        bigEnd\r\n      );\r\n      for (tag in exifData) {\r\n        switch (tag) {\r\n          case 'LightSource':\r\n          case 'Flash':\r\n          case 'MeteringMode':\r\n          case 'ExposureProgram':\r\n          case 'SensingMethod':\r\n          case 'SceneCaptureType':\r\n          case 'SceneType':\r\n          case 'CustomRendered':\r\n          case 'WhiteBalance':\r\n          case 'GainControl':\r\n          case 'Contrast':\r\n          case 'Saturation':\r\n          case 'Sharpness':\r\n          case 'SubjectDistanceRange':\r\n          case 'FileSource':\r\n            exifData[tag] = StringValues[tag][exifData[tag]];\r\n            break;\r\n\r\n          case 'ExifVersion':\r\n          case 'FlashpixVersion':\r\n            exifData[tag] = String.fromCharCode(\r\n              exifData[tag][0],\r\n              exifData[tag][1],\r\n              exifData[tag][2],\r\n              exifData[tag][3]\r\n            );\r\n            break;\r\n\r\n          case 'ComponentsConfiguration':\r\n            exifData[tag] =\r\n              StringValues.Components[exifData[tag][0]] +\r\n              StringValues.Components[exifData[tag][1]] +\r\n              StringValues.Components[exifData[tag][2]] +\r\n              StringValues.Components[exifData[tag][3]];\r\n            break;\r\n        }\r\n        tags[tag] = exifData[tag];\r\n      }\r\n    }\r\n\r\n    if (tags.GPSInfoIFDPointer) {\r\n      gpsData = readTags(\r\n        file,\r\n        tiffOffset,\r\n        tiffOffset + tags.GPSInfoIFDPointer,\r\n        GPSTags,\r\n        bigEnd\r\n      );\r\n      for (tag in gpsData) {\r\n        switch (tag) {\r\n          case 'GPSVersionID':\r\n            gpsData[tag] =\r\n              gpsData[tag][0] +\r\n              '.' +\r\n              gpsData[tag][1] +\r\n              '.' +\r\n              gpsData[tag][2] +\r\n              '.' +\r\n              gpsData[tag][3];\r\n            break;\r\n        }\r\n        tags[tag] = gpsData[tag];\r\n      }\r\n    }\r\n\r\n    // extract thumbnail\r\n    tags['thumbnail'] = readThumbnailImage(\r\n      file,\r\n      tiffOffset,\r\n      firstIFDOffset,\r\n      bigEnd\r\n    );\r\n\r\n    return tags;\r\n  }\r\n\r\n  function findXMPinJPEG(file) {\r\n    if (!('DOMParser' in self)) {\r\n      // console.warn('XML parsing not supported without DOMParser');\r\n      return;\r\n    }\r\n    var dataView = new DataView(file);\r\n\r\n    if (debug) console.log('Got file of length ' + file.byteLength);\r\n    if (dataView.getUint8(0) != 0xff || dataView.getUint8(1) != 0xd8) {\r\n      if (debug) console.log('Not a valid JPEG');\r\n      return false; // not a valid jpeg\r\n    }\r\n\r\n    var offset = 2,\r\n      length = file.byteLength,\r\n      dom = new DOMParser();\r\n\r\n    while (offset < length - 4) {\r\n      if (getStringFromDB(dataView, offset, 4) == 'http') {\r\n        var startOffset = offset - 1;\r\n        var sectionLength = dataView.getUint16(offset - 2) - 1;\r\n        var xmpString = getStringFromDB(dataView, startOffset, sectionLength);\r\n        var xmpEndIndex = xmpString.indexOf('xmpmeta>') + 8;\r\n        xmpString = xmpString.substring(\r\n          xmpString.indexOf('<x:xmpmeta'),\r\n          xmpEndIndex\r\n        );\r\n\r\n        var indexOfXmp = xmpString.indexOf('x:xmpmeta') + 10;\r\n        //Many custom written programs embed xmp/xml without any namespace. Following are some of them.\r\n        //Without these namespaces, XML is thought to be invalid by parsers\r\n        xmpString =\r\n          xmpString.slice(0, indexOfXmp) +\r\n          'xmlns:Iptc4xmpCore=\"http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/\" ' +\r\n          'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" ' +\r\n          'xmlns:tiff=\"http://ns.adobe.com/tiff/1.0/\" ' +\r\n          'xmlns:plus=\"http://schemas.android.com/apk/lib/com.google.android.gms.plus\" ' +\r\n          'xmlns:ext=\"http://www.gettyimages.com/xsltExtension/1.0\" ' +\r\n          'xmlns:exif=\"http://ns.adobe.com/exif/1.0/\" ' +\r\n          'xmlns:stEvt=\"http://ns.adobe.com/xap/1.0/sType/ResourceEvent#\" ' +\r\n          'xmlns:stRef=\"http://ns.adobe.com/xap/1.0/sType/ResourceRef#\" ' +\r\n          'xmlns:crs=\"http://ns.adobe.com/camera-raw-settings/1.0/\" ' +\r\n          'xmlns:xapGImg=\"http://ns.adobe.com/xap/1.0/g/img/\" ' +\r\n          'xmlns:Iptc4xmpExt=\"http://iptc.org/std/Iptc4xmpExt/2008-02-29/\" ' +\r\n          xmpString.slice(indexOfXmp);\r\n\r\n        var domDocument = dom.parseFromString(xmpString, 'text/xml');\r\n        return xml2Object(domDocument);\r\n      } else {\r\n        offset++;\r\n      }\r\n    }\r\n  }\r\n\r\n  function xml2json(xml) {\r\n    var json = {};\r\n\r\n    if (xml.nodeType == 1) {\r\n      // element node\r\n      if (xml.attributes.length > 0) {\r\n        json['@attributes'] = {};\r\n        for (var j = 0; j < xml.attributes.length; j++) {\r\n          var attribute = xml.attributes.item(j);\r\n          json['@attributes'][attribute.nodeName] = attribute.nodeValue;\r\n        }\r\n      }\r\n    } else if (xml.nodeType == 3) {\r\n      // text node\r\n      return xml.nodeValue;\r\n    }\r\n\r\n    // deal with children\r\n    if (xml.hasChildNodes()) {\r\n      for (var i = 0; i < xml.childNodes.length; i++) {\r\n        var child = xml.childNodes.item(i);\r\n        var nodeName = child.nodeName;\r\n        if (json[nodeName] == null) {\r\n          json[nodeName] = xml2json(child);\r\n        } else {\r\n          if (json[nodeName].push == null) {\r\n            var old = json[nodeName];\r\n            json[nodeName] = [];\r\n            json[nodeName].push(old);\r\n          }\r\n          json[nodeName].push(xml2json(child));\r\n        }\r\n      }\r\n    }\r\n\r\n    return json;\r\n  }\r\n\r\n  function xml2Object(xml) {\r\n    try {\r\n      var obj = {};\r\n      if (xml.children.length > 0) {\r\n        for (var i = 0; i < xml.children.length; i++) {\r\n          var item = xml.children.item(i);\r\n          var attributes = item.attributes;\r\n          for (var idx in attributes) {\r\n            var itemAtt = attributes[idx];\r\n            var dataKey = itemAtt.nodeName;\r\n            var dataValue = itemAtt.nodeValue;\r\n\r\n            if (dataKey !== undefined) {\r\n              obj[dataKey] = dataValue;\r\n            }\r\n          }\r\n          var nodeName = item.nodeName;\r\n\r\n          if (typeof obj[nodeName] == 'undefined') {\r\n            obj[nodeName] = xml2json(item);\r\n          } else {\r\n            if (typeof obj[nodeName].push == 'undefined') {\r\n              var old = obj[nodeName];\r\n\r\n              obj[nodeName] = [];\r\n              obj[nodeName].push(old);\r\n            }\r\n            obj[nodeName].push(xml2json(item));\r\n          }\r\n        }\r\n      } else {\r\n        obj = xml.textContent;\r\n      }\r\n      return obj;\r\n    } catch (e) {\r\n      console.log(e.message);\r\n    }\r\n  }\r\n\r\n  EXIF.enableXmp = function () {\r\n    EXIF.isXmpEnabled = true;\r\n  };\r\n\r\n  EXIF.disableXmp = function () {\r\n    EXIF.isXmpEnabled = false;\r\n  };\r\n\r\n  EXIF.getData = function (img, callback) {\r\n    if (\r\n      ((self.Image && img instanceof self.Image) ||\r\n        (self.HTMLImageElement && img instanceof self.HTMLImageElement)) &&\r\n      !img.complete\r\n    )\r\n      return false;\r\n\r\n    if (!imageHasData(img)) {\r\n      getImageData(img, callback);\r\n    } else {\r\n      if (callback) {\r\n        callback.call(img);\r\n      }\r\n    }\r\n    return true;\r\n  };\r\n\r\n  EXIF.getTag = function (img, tag) {\r\n    if (!imageHasData(img)) return;\r\n    return img.exifdata[tag];\r\n  };\r\n\r\n  EXIF.getIptcTag = function (img, tag) {\r\n    if (!imageHasData(img)) return;\r\n    return img.iptcdata[tag];\r\n  };\r\n\r\n  EXIF.getAllTags = function (img) {\r\n    if (!imageHasData(img)) return {};\r\n    var a,\r\n      data = img.exifdata,\r\n      tags = {};\r\n    for (a in data) {\r\n      if (data.hasOwnProperty(a)) {\r\n        tags[a] = data[a];\r\n      }\r\n    }\r\n    return tags;\r\n  };\r\n\r\n  EXIF.getAllIptcTags = function (img) {\r\n    if (!imageHasData(img)) return {};\r\n    var a,\r\n      data = img.iptcdata,\r\n      tags = {};\r\n    for (a in data) {\r\n      if (data.hasOwnProperty(a)) {\r\n        tags[a] = data[a];\r\n      }\r\n    }\r\n    return tags;\r\n  };\r\n\r\n  EXIF.pretty = function (img) {\r\n    if (!imageHasData(img)) return '';\r\n    var a,\r\n      data = img.exifdata,\r\n      strPretty = '';\r\n    for (a in data) {\r\n      if (data.hasOwnProperty(a)) {\r\n        if (typeof data[a] == 'object') {\r\n          if (data[a] instanceof Number) {\r\n            strPretty +=\r\n              a +\r\n              ' : ' +\r\n              data[a] +\r\n              ' [' +\r\n              data[a].numerator +\r\n              '/' +\r\n              data[a].denominator +\r\n              ']\\r\\n';\r\n          } else {\r\n            strPretty += a + ' : [' + data[a].length + ' values]\\r\\n';\r\n          }\r\n        } else {\r\n          strPretty += a + ' : ' + data[a] + '\\r\\n';\r\n        }\r\n      }\r\n    }\r\n    return strPretty;\r\n  };\r\n\r\n  EXIF.readFromBinaryFile = function (file) {\r\n    return findEXIFinJPEG(file);\r\n  };\r\n\r\n  if (typeof define === 'function' && define.amd) {\r\n    define('exif-js', [], function () {\r\n      return EXIF;\r\n    });\r\n  }\r\n}.call(this));\r\n","import styled from 'styled-px2vw';\r\nimport pkg from '../../../package.json';\r\n\r\nconst themeColor = pkg.theme['brand-primary'];\r\n\r\nexport const TabBarBox = styled.div`\r\n  background-color: #fafafa;\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  padding-bottom: constant(safe-area-inset-bottom);\r\n  padding-bottom: env(safe-area-inset-bottom);\r\n`;\r\n\r\nexport const BottomBlank = styled.div`\r\n  width: 100%;\r\n  height: 110px;\r\n  padding-bottom: constant(safe-area-inset-bottom);\r\n  padding-bottom: env(safe-area-inset-bottom);\r\n`;\r\nexport const TabBarInner = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 28px 96px 0;\r\n`;\r\nexport const TabBarItem = styled.div`\r\n  color: #bfbfbf;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  overflow: hidden;\r\n  &.active {\r\n    color: ${themeColor};\r\n  }\r\n`;\r\n\r\nexport const ItemIcon = styled.span`\r\n  display: inline-block;\r\n  width: 48px;\r\n  height: 48px;\r\n  font-size: 40px;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\nexport const ItemTitle = styled.div`\r\n  font-size: 22px;\r\n  height: 40px;\r\n  line-height: 40px;\r\n`;\r\n","import React from 'react';\r\nimport {\r\n  TabBarBox,\r\n  TabBarItem,\r\n  TabBarInner,\r\n  ItemIcon,\r\n  ItemTitle,\r\n} from './styles';\r\n\r\ninterface TabBarProps {\r\n  handelClick: (type: string) => void;\r\n  type: string;\r\n}\r\n\r\nconst TabBar: React.FC<TabBarProps> = (props) => {\r\n  const { handelClick, type } = props;\r\n  return (\r\n    <>\r\n      <TabBarBox>\r\n        <TabBarInner>\r\n          <TabBarItem\r\n            onClick={(): void => handelClick('library')}\r\n            className={type === 'library' ? 'active' : ''}\r\n          >\r\n            <ItemIcon className=\"iconfont icon-library\" />\r\n            <ItemTitle>题库</ItemTitle>\r\n          </TabBarItem>\r\n          <TabBarItem\r\n            onClick={(): void => handelClick('find')}\r\n            className={type === 'find' ? 'active' : ''}\r\n          >\r\n            <ItemIcon className=\"iconfont icon-find\" />\r\n            <ItemTitle>发现</ItemTitle>\r\n          </TabBarItem>\r\n          <TabBarItem\r\n            onClick={(): void => handelClick('user-center')}\r\n            className={type === 'user-center' ? 'active' : ''}\r\n          >\r\n            <ItemIcon className=\"iconfont icon-my\" />\r\n            <ItemTitle>我的</ItemTitle>\r\n          </TabBarItem>\r\n        </TabBarInner>\r\n      </TabBarBox>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default TabBar;\r\n","import React, {\r\n  ReactElement,\r\n  useCallback,\r\n  useContext,\r\n  useEffect,\r\n  useMemo,\r\n  useState,\r\n} from 'react';\r\nimport {\r\n  Accordion,\r\n  Picker,\r\n  WhiteSpace,\r\n  Button,\r\n  Card,\r\n  Toast,\r\n} from 'antd-mobile';\r\nimport PickItem from '@/components/PickItem';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { ProviderContext } from '@/reducer/context';\r\nimport { useLazyQuery, useQuery } from '@apollo/client';\r\nimport { QUERY_SUBJECT, SUBJECT_TAGS, USER_SHOW } from '@/helpers/APIHelper';\r\nimport { examEnum, subjectEnum } from '@/constants/globalDatas';\r\nimport { BottomBlank } from '@/components/TabBar/styles';\r\nimport {\r\n  AccordionBottom,\r\n  AccordionBox,\r\n  AccordionItem,\r\n  AccordionLeft,\r\n  AccordionLeftStarBox,\r\n  AccordionLeftTite,\r\n  AccordionRight,\r\n  Content,\r\n  Star,\r\n  StarBox,\r\n  StarFont,\r\n  TabBarBox,\r\n  TabBarItem,\r\n} from './styles';\r\nimport stringArrToPickArr from './utils/stringArrToPickArr';\r\nimport { filterSourceType, filterExamId } from './utils/filterArr';\r\nimport dateToYear from './utils/dateToYear';\r\n\r\nconst Library: React.FC = () => {\r\n  // const [ejuSubjectValue, setEjuSubjectValue] = useState<string[]>(['maths1']); // 科目选中值,默认选中maths1\r\n  const [subjectArr, setSubjectArr] = useState([{ value: '', label: '' }]); // 科目下拉选项\r\n  const { data: userInfo } = useQuery(USER_SHOW);\r\n  const [subjectReq, { data: sujectData, loading: subjectLoading }] =\r\n    useLazyQuery(QUERY_SUBJECT); // 查询下拉选项数据\r\n  const [\r\n    subjectTagsReq,\r\n    { data: subjectTagsData, loading: subjectTagLoading },\r\n  ] = useLazyQuery(SUBJECT_TAGS); // 查询该科目下所有题目\r\n\r\n  const {\r\n    subjectTags,\r\n    getUserTagAbilities,\r\n    subjectExams = [],\r\n    getExamHistoryBySubject = [],\r\n  } = subjectTagsData || {};\r\n  const filterExam = useMemo(\r\n    () => filterSourceType(subjectExams),\r\n    [subjectExams]\r\n  ); // 过滤后的考试题目\r\n  const filterExamHis = useMemo(\r\n    () => filterExamId(getExamHistoryBySubject),\r\n    [getExamHistoryBySubject]\r\n  ); // 过滤后的考试记录\r\n  const { state, dispatch } = useContext(ProviderContext);\r\n  const { tabType, ejuSubjectValue } = state;\r\n  const history = useHistory();\r\n  // 切换标签\r\n  const handleTabChange = (type: string): void => {\r\n    dispatch?.({ type: 'setTabType', tabType: type });\r\n  };\r\n  // 根据tabType获取相应的sourceType\r\n  const tabTypeToSourceType = useMemo(() => {\r\n    switch (tabType) {\r\n      case 'quick':\r\n        return 'gaokao';\r\n      case 'topic':\r\n      case 'exam':\r\n        return 'center';\r\n      default:\r\n        return '';\r\n    }\r\n  }, [tabType]);\r\n  // 设置星值\r\n  const setAbilities = useCallback(\r\n    (prevTag: string): ReactElement => {\r\n      let abilities = 0;\r\n      const startArr = [];\r\n      getUserTagAbilities?.forEach(\r\n        (item: { tagId: string; abilityValue: string }) => {\r\n          const { tagId, abilityValue } = item;\r\n          if (prevTag === tagId) {\r\n            abilities = Math.round(Number(abilityValue) / 20);\r\n          }\r\n        }\r\n      );\r\n      for (let i = 1; i <= 5; i += 1) {\r\n        if (abilities === 5) {\r\n          startArr.push(<Star key={i} className=\"all iconfont icon-star1\" />);\r\n        } else if (i <= abilities) {\r\n          startArr.push(\r\n            <Star key={i} className=\"active iconfont icon-star1\" />\r\n          );\r\n        } else {\r\n          startArr.push(<Star key={i} />);\r\n        }\r\n      }\r\n      return <>{startArr}</>;\r\n    },\r\n    [getUserTagAbilities]\r\n  );\r\n\r\n  // 获取智能速答题目\r\n  const getQuick = useCallback(() => {\r\n    return subjectTags?.tags?.map((item: any) => {\r\n      const { _id, name, children = [] } = item;\r\n      return (\r\n        <div key={_id}>\r\n          <Card>\r\n            <Card.Header title={name} />\r\n            <Card.Body>\r\n              <Accordion>\r\n                {children.map((item2: any) => {\r\n                  const {\r\n                    name: name2,\r\n                    _id: _id2,\r\n                    children: children2 = [],\r\n                  } = item2;\r\n                  return (\r\n                    <Accordion.Panel\r\n                      header={name2}\r\n                      key={_id2}\r\n                      style={{ marginBottom: '10px' }}\r\n                    >\r\n                      <AccordionBox>\r\n                        {children2.map((item3: any) => {\r\n                          const { name: name3, _id: _id3 } = item3;\r\n                          const abilities = setAbilities(_id3);\r\n                          return (\r\n                            <AccordionItem key={_id3}>\r\n                              <AccordionLeftTite>{name3}</AccordionLeftTite>\r\n                              <AccordionBottom>\r\n                                <AccordionLeft>\r\n                                  <AccordionLeftStarBox>\r\n                                    <StarFont>菓星值</StarFont>\r\n                                    <StarBox>{abilities}</StarBox>\r\n                                  </AccordionLeftStarBox>\r\n                                </AccordionLeft>\r\n                                <AccordionRight>\r\n                                  <Button\r\n                                    type=\"primary\"\r\n                                    size=\"small\"\r\n                                    inline\r\n                                    onClick={(): void =>\r\n                                      history.push(\r\n                                        `/quick?subject=${\r\n                                          subjectTags?.subject || ''\r\n                                        }&tagId=${\r\n                                          _id3 || ''\r\n                                        }&tag=${name3}&sourceType=${tabTypeToSourceType}`\r\n                                      )\r\n                                    }\r\n                                  >\r\n                                    开始练习\r\n                                  </Button>\r\n                                </AccordionRight>\r\n                              </AccordionBottom>\r\n                            </AccordionItem>\r\n                          );\r\n                        })}\r\n                      </AccordionBox>\r\n                    </Accordion.Panel>\r\n                  );\r\n                })}\r\n              </Accordion>\r\n            </Card.Body>\r\n          </Card>\r\n          <WhiteSpace size=\"lg\" />\r\n        </div>\r\n      );\r\n    });\r\n  }, [\r\n    history,\r\n    setAbilities,\r\n    subjectTags?.subject,\r\n    subjectTags?.tags,\r\n    tabTypeToSourceType,\r\n  ]);\r\n\r\n  // 开始考试联系\r\n  const handleToExamInfo = useCallback(\r\n    (data) => {\r\n      dispatch?.({ type: 'setExam', exam: data });\r\n      history.push('/exam-info');\r\n    },\r\n    [dispatch, history]\r\n  );\r\n  // 获取套卷模拟\r\n  const getExam = useCallback(() => {\r\n    return (\r\n      <Accordion>\r\n        {filterExam.map((item) => {\r\n          return (\r\n            <Accordion.Panel\r\n              header={examEnum[item.sourceType as keyof typeof examEnum]}\r\n              style={{ marginBottom: '20px' }}\r\n              key={item.sourceType}\r\n            >\r\n              <AccordionBox>\r\n                {item.children.map((val) => {\r\n                  const { date: examDate } = val;\r\n                  return (\r\n                    <AccordionItem key={val._id}>\r\n                      <AccordionLeftTite>\r\n                        {dateToYear(examDate)}\r\n                      </AccordionLeftTite>\r\n                      <AccordionBottom>\r\n                        <AccordionLeft>\r\n                          <AccordionLeftStarBox>\r\n                            <StarFont>\r\n                              个人历史最高分：\r\n                              {filterExamHis[val._id]?.bestPoints}\r\n                            </StarFont>\r\n                          </AccordionLeftStarBox>\r\n                        </AccordionLeft>\r\n                        <AccordionRight>\r\n                          <Button\r\n                            type=\"primary\"\r\n                            size=\"small\"\r\n                            inline\r\n                            onClick={(): void =>\r\n                              handleToExamInfo({\r\n                                exam: val,\r\n                                examHis: filterExamHis[val._id],\r\n                              })\r\n                            }\r\n                          >\r\n                            开始练习\r\n                          </Button>\r\n                        </AccordionRight>\r\n                      </AccordionBottom>\r\n                    </AccordionItem>\r\n                  );\r\n                })}\r\n              </AccordionBox>\r\n            </Accordion.Panel>\r\n          );\r\n        })}\r\n      </Accordion>\r\n    );\r\n  }, [filterExam, filterExamHis, handleToExamInfo]);\r\n\r\n  // 获取专题模拟\r\n  const getTopic = useCallback(() => {\r\n    return subjectTags?.tags?.map((item: any) => {\r\n      const { _id, name } = item;\r\n      const abilities = setAbilities(_id);\r\n\r\n      return (\r\n        <AccordionItem key={_id}>\r\n          <AccordionLeftTite>{name}</AccordionLeftTite>\r\n          <AccordionBottom>\r\n            <AccordionLeft>\r\n              <AccordionLeftStarBox>\r\n                <StarFont>菓星值</StarFont>\r\n                <StarBox>{abilities}</StarBox>\r\n              </AccordionLeftStarBox>\r\n            </AccordionLeft>\r\n            <AccordionRight>\r\n              <Button\r\n                type=\"primary\"\r\n                size=\"small\"\r\n                inline\r\n                onClick={(): void =>\r\n                  history.push(\r\n                    `/topic?subject=${subjectTags?.subject || ''}&tagId=${\r\n                      _id || ''\r\n                    }&tag=${name}`\r\n                  )\r\n                }\r\n              >\r\n                开始练习\r\n              </Button>\r\n            </AccordionRight>\r\n          </AccordionBottom>\r\n        </AccordionItem>\r\n      );\r\n    });\r\n  }, [history, setAbilities, subjectTags?.subject, subjectTags?.tags]);\r\n\r\n  // 更改科目选项\r\n  const changeEjuSubject = (value: string[]): void => {\r\n    dispatch?.({ type: 'setEjuSubjectValue', ejuSubjectValue: value });\r\n  };\r\n\r\n  // 查询题库筛选科目的值\r\n  useEffect(() => {\r\n    subjectReq({\r\n      variables: {\r\n        sourceType: tabTypeToSourceType,\r\n      },\r\n    });\r\n  }, [subjectReq, tabTypeToSourceType]);\r\n  // 查询科目下所有题目\r\n  useEffect(() => {\r\n    const subject = ejuSubjectValue?.[0];\r\n    subject &&\r\n      subjectTagsReq({\r\n        variables: {\r\n          sourceType: tabTypeToSourceType,\r\n          subject,\r\n        },\r\n      });\r\n  }, [ejuSubjectValue, subjectTagsReq, tabTypeToSourceType]);\r\n  // 设置下拉选项\r\n  useEffect(() => {\r\n    const { typeSubjects } = sujectData || {};\r\n    if (typeSubjects) {\r\n      setSubjectArr(stringArrToPickArr(typeSubjects, subjectEnum));\r\n    }\r\n  }, [sujectData]);\r\n  // 接口loading\r\n  useEffect(() => {\r\n    (subjectLoading || subjectTagLoading) && Toast.loading('加载中', 0);\r\n    !subjectLoading && !subjectTagLoading && Toast.hide();\r\n  }, [subjectLoading, subjectTagLoading]);\r\n\r\n  // 缓存用户信息接口\r\n  useEffect(() => {\r\n    const userData = userInfo?.getUserInfo;\r\n    if (userData) {\r\n      dispatch?.({ type: 'setUserInfo', userInfo: userData });\r\n      // 提前加载头像图片\r\n      if (userData.avatar) {\r\n        const prevImg = new Image();\r\n        prevImg.src = userData.avatar;\r\n      }\r\n    }\r\n  }, [dispatch, userInfo?.getUserInfo]);\r\n  return (\r\n    <Content>\r\n      <TabBarBox>\r\n        <TabBarItem\r\n          className={tabType === 'quick' ? 'active' : ''}\r\n          onClick={(): void => handleTabChange('quick')}\r\n        >\r\n          智能速答\r\n        </TabBarItem>\r\n        <TabBarItem\r\n          className={tabType === 'topic' ? 'active' : ''}\r\n          onClick={(): void => handleTabChange('topic')}\r\n        >\r\n          专题模拟\r\n        </TabBarItem>\r\n        <TabBarItem\r\n          className={tabType === 'exam' ? 'active' : ''}\r\n          onClick={(): void => handleTabChange('exam')}\r\n        >\r\n          套卷模拟\r\n        </TabBarItem>\r\n      </TabBarBox>\r\n      <WhiteSpace size=\"xl\" />\r\n\r\n      <Picker\r\n        data={subjectArr}\r\n        cols={1}\r\n        value={ejuSubjectValue}\r\n        onOk={(value: string[]): void => changeEjuSubject(value)}\r\n      >\r\n        <PickItem placeholder=\"请选择考学科目\" />\r\n      </Picker>\r\n      {tabType === 'quick' && getQuick()}\r\n      {tabType === 'topic' && getTopic()}\r\n      {tabType === 'exam' && getExam()}\r\n      <BottomBlank />\r\n    </Content>\r\n  );\r\n};\r\n\r\nexport default Library;\r\n","export interface FilterSourceTypeProps {\r\n  date: string;\r\n  sourceType: string;\r\n  subject: string;\r\n  _id: string;\r\n  fullPoints: number;\r\n  timeLimit: number;\r\n}\r\ninterface FilterSourceTypeReturn {\r\n  sourceType: string;\r\n  children: FilterSourceTypeProps[];\r\n}\r\nexport function filterSourceType(\r\n  arr: FilterSourceTypeProps[]\r\n): FilterSourceTypeReturn[] {\r\n  const comMap: { [key: string]: FilterSourceTypeProps[] } = {}; // 用于比对是否已存当前项\r\n  const resultArr: FilterSourceTypeReturn[] = []; // 最后过滤好的数据\r\n  arr?.forEach((item) => {\r\n    const { sourceType } = item;\r\n    if (comMap[sourceType as keyof typeof comMap]) {\r\n      comMap[sourceType as keyof typeof comMap].push(item);\r\n    } else {\r\n      comMap[sourceType as keyof typeof comMap] = [{ ...item }];\r\n    }\r\n  });\r\n  Object.keys(comMap).forEach((key) => {\r\n    resultArr.push({\r\n      sourceType: key,\r\n      children: comMap[key],\r\n    });\r\n  });\r\n  return resultArr;\r\n}\r\n\r\nexport interface FilterExamIdProps {\r\n  bestPoints: number;\r\n  examId: string;\r\n  frequency: number;\r\n  previousPoints: number;\r\n  subject: string;\r\n  timeCounter: number;\r\n  userId: string;\r\n}\r\ninterface FilterExamIdReturn {\r\n  [key: string]: FilterExamIdProps;\r\n}\r\nexport function filterExamId(arr: FilterExamIdProps[]): FilterExamIdReturn {\r\n  const resultMap: FilterExamIdReturn = {};\r\n  arr?.forEach((item) => {\r\n    const { examId } = item || {};\r\n    resultMap[examId as keyof typeof resultMap] = item;\r\n  });\r\n  return resultMap;\r\n}\r\n","export default __webpack_public_path__ + \"assets/images/avatar-defaulta4605a43.jpg\";","import styled from 'styled-px2vw';\r\nimport pkg from '../../../package.json';\r\nimport star2 from './images/icon-star2.svg';\r\n\r\nconst themeColor = pkg.theme['brand-primary'];\r\n\r\nexport const Page = styled.div``;\r\n\r\nexport const TabBox = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-around;\r\n  height: 128px;\r\n`;\r\n\r\nexport const TabItem = styled.div`\r\n  width: 190px;\r\n  height: 50px;\r\n  border-radius: 60px;\r\n  font-size: 32px;\r\n  letter-spacing: 0.4px;\r\n  font-weight: bold;\r\n  color: #7f7f7f;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  &.active {\r\n    color: #fff;\r\n    background-color: ${themeColor};\r\n  }\r\n`;\r\n\r\nexport const InfoBox = styled.div`\r\n  background: ${themeColor};\r\n  border-radius: 0px 0px 30px 30px;\r\n  padding: 20px 74px;\r\n  position: relative;\r\n  z-index: 1;\r\n`;\r\n\r\nexport const InfoLi = styled.div`\r\n  height: 70px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n`;\r\n\r\nexport const InfoItem = styled.div`\r\n  min-width: 124px;\r\n  color: #fff;\r\n  flex: 1;\r\n`;\r\n\r\nexport const IconStar = styled.span`\r\n  display: inline-flex;\r\n  width: 36px;\r\n  height: 34px;\r\n  background: url(${star2}) no-repeat center;\r\n  margin-right: 16px;\r\n  background-size: contain;\r\n  align-items: center;\r\n  justify-content: center;\r\n  &:last-child {\r\n    margin-right: 0;\r\n  }\r\n  &.icon-star1 {\r\n    background-image: none;\r\n    color: #ffcc00;\r\n  }\r\n`;\r\n\r\n// 图标\r\nexport const StrengthPage = styled.div`\r\n  padding: 20px 40px;\r\n`;\r\nexport const SelectBox = styled.div`\r\n  padding-top: 20px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-around;\r\n`;\r\n\r\nexport const SelectBoxItem = styled.div`\r\n  width: 50%;\r\n  flex-shrink: 0;\r\n`;\r\n\r\nexport const Table = styled.table`\r\n  width: 100%;\r\n`;\r\nexport const Tr = styled.tr`\r\n  height: 50px;\r\n`;\r\n\r\nexport const Td = styled.td`\r\n  vertical-align: middle;\r\n  font-size: 28px;\r\n  text-align: center;\r\n`;\r\nexport const Th = styled.th`\r\n  font-size: 32px;\r\n  color: ${themeColor};\r\n`;\r\n\r\nexport const RadarScroll = styled.div`\r\n  height: calc(100vh - 395px);\r\n  overflow-y: auto;\r\n`;\r\n\r\nexport const PredictBox = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 20px 30px;\r\n`;\r\nexport const PredictBoxButton = styled.button`\r\n  background: #f8fffc;\r\n  border: 1px solid ${themeColor};\r\n  box-sizing: border-box;\r\n  border-radius: 16px;\r\n  flex-shrink: 0;\r\n  width: 166px;\r\n  height: 74px;\r\n  color: ${themeColor};\r\n  font-size: 32px;\r\n`;\r\nexport const PredictBoxFont = styled.div`\r\n  font-weight: bold;\r\n  font-size: 40px;\r\n  letter-spacing: 0.3px;\r\n  color: ${themeColor};\r\n`;\r\n\r\nexport const PredictSelect = styled.div`\r\n  padding-right: 30px;\r\n`;\r\n\r\nexport const PredictScroll = styled.div`\r\n  height: calc(100vh - 308px);\r\n  overflow-y: auto;\r\n`;\r\n// 天梯排行\r\nexport const LadderBox = styled.div`\r\n  background-color: #f5f5f5;\r\n  position: absolute;\r\n  top: 128px;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n`;\r\n\r\nexport const LadderContent = styled.div`\r\n  position: absolute;\r\n  top: 180px;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n`;\r\nexport const RankHeader = styled.div`\r\n  height: 126px;\r\n  padding: 34px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n`;\r\n\r\nexport const ItemFirst = styled.div`\r\n  width: 64px;\r\n  flex-shrink: 0;\r\n  color: #bdbdbd;\r\n  font-size: 32px;\r\n  text-align: center;\r\n`;\r\nexport const ItemSecond = styled.div<{ pl?: string }>`\r\n  width: 450px;\r\n  padding-left: ${(props): string => props.pl || '0px'};\r\n  color: #bdbdbd;\r\n  font-size: 32px;\r\n`;\r\nexport const ItemThird = styled.div`\r\n  display: inline-flex;\r\n  width: 160px;\r\n  flex-shrink: 0;\r\n  font-size: 32px;\r\n  justify-content: flex-end;\r\n`;\r\n\r\nexport const RankList = styled.div`\r\n  position: absolute;\r\n  top: 126px;\r\n  bottom: 0px;\r\n  left: 0;\r\n  right: 0;\r\n  overflow-y: auto;\r\n  background-color: #fff;\r\n`;\r\n\r\nexport const RankItem = styled.div`\r\n  height: 144px;\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 0 34px;\r\n  &.my {\r\n    background-color: #d7efe0;\r\n  }\r\n`;\r\n\r\nexport const RankItemCenter = styled.div`\r\n  display: inline-flex;\r\n  align-items: center;\r\n  color: #000;\r\n  width: 100%;\r\n`;\r\nexport const RankItemStart = styled(RankItemCenter)``;\r\n\r\nexport const RankAvatar = styled.div<{ img: string }>`\r\n  display: inline-block;\r\n  width: 84px;\r\n  height: 84px;\r\n  border-radius: 50%;\r\n  background-image: url(${(prop): string => prop.img || ''});\r\n  background-size: cover;\r\n  background-position: center;\r\n  margin-right: 24px;\r\n`;\r\nexport const RankName = styled.div`\r\n  width: 340px;\r\n  overflow: hidden;\r\n  white-space: nowrap;\r\n  text-overflow: ellipsis;\r\n  height: 84px;\r\n  line-height: 84px;\r\n`;\r\n\r\nexport const RankItemEnd = styled.div`\r\n  display: inline-flex;\r\n  align-items: center;\r\n  color: #bfbfbf;\r\n`;\r\n\r\nexport const RankIcon = styled.span`\r\n  display: inline-flex;\r\n  width: 46px;\r\n  height: 45px;\r\n  font-size: 46px;\r\n  margin-left: 46px;\r\n  align-items: center;\r\n  justify-content: center;\r\n  &.icon-up {\r\n    color: ${themeColor};\r\n  }\r\n  &.icon-down {\r\n    color: #f5222d;\r\n  }\r\n  &.icon-no-change:before {\r\n    display: inline-block;\r\n    width: 40px;\r\n    height: 6px;\r\n    background-color: #bcbcbc;\r\n  }\r\n`;\r\n\r\nexport const SelectItem = styled.div`\r\n  width: 248px;\r\n  height: 74px;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  padding: 0 48px 0 28px;\r\n  justify-content: space-between;\r\n  border-radius: 16px;\r\n  border: 1px solid #e8e8e8;\r\n  background: #fff;\r\n`;\r\nexport const IconArrow = styled.span`\r\n  width: 40px;\r\n  height: 25px;\r\n  display: inline-block;\r\n  font-size: 25px;\r\n  color: ${themeColor};\r\n`;\r\n","export default \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHZpZXdCb3g9IjAgMCAxOCAxOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik03LjMwNzI1IDQuMjE5ODZDNy45NDkzMiAyLjYxOTE4IDguMjcwMzYgMS44MTg4MyA4Ljc5MTkzIDEuNzA3OTFDOC45MjkwOCAxLjY3ODc0IDkuMDcwODMgMS42Nzg3NCA5LjIwNzk3IDEuNzA3OTFDOS43Mjk1NSAxLjgxODgzIDEwLjA1MDYgMi42MTkxOCAxMC42OTI3IDQuMjE5ODZDMTEuMDU3OCA1LjEzMDE0IDExLjI0MDQgNS41ODUyOCAxMS41ODIgNS44OTQ4NUMxMS42Nzc4IDUuOTgxNjggMTEuNzgxOCA2LjA1OTAxIDExLjg5MjYgNi4xMjU3NkMxMi4yODc0IDYuMzYzNzQgMTIuNzgwMyA2LjQwNzg4IDEzLjc2NjEgNi40OTYxN0MxNS40MzQ4IDYuNjQ1NjIgMTYuMjY5MiA2LjcyMDM0IDE2LjUyNCA3LjE5NjA5QzE2LjU3NjggNy4yOTQ2MiAxNi42MTI3IDcuNDAxMyAxNi42MzAyIDcuNTExNjlDMTYuNzE0NiA4LjA0NDcyIDE2LjEwMTIgOC42MDI3OCAxNC44NzQ0IDkuNzE4OUwxNC41MzM4IDEwLjAyODhDMTMuOTYwMiAxMC41NTA2IDEzLjY3MzUgMTAuODExNSAxMy41MDc2IDExLjEzNzJDMTMuNDA4MSAxMS4zMzI1IDEzLjM0MTQgMTEuNTQyOCAxMy4zMTAxIDExLjc1OThDMTMuMjU4IDEyLjEyMTUgMTMuMzQyIDEyLjUgMTMuNTA5OSAxMy4yNTY5TDEzLjU2OTkgMTMuNTI3NEMxMy44NzExIDE0Ljg4NDkgMTQuMDIxNyAxNS41NjM3IDEzLjgzMzcgMTUuODk3M0MxMy42NjQ5IDE2LjE5NyAxMy4zNTM4IDE2LjM4ODkgMTMuMDEwMiAxNi40MDUzQzEyLjYyNzcgMTYuNDIzNiAxMi4wODg3IDE1Ljk4NDQgMTEuMDEwNyAxNS4xMDZDMTAuMzAwNSAxNC41MjczIDkuOTQ1NDIgMTQuMjM3OSA5LjU1MTIxIDE0LjEyNDlDOS4xOTA5NyAxNC4wMjE2IDguODA4OTQgMTQuMDIxNiA4LjQ0ODY5IDE0LjEyNDlDOC4wNTQ0OCAxNC4yMzc5IDcuNjk5MzggMTQuNTI3MyA2Ljk4OTE3IDE1LjEwNkM1LjkxMTE5IDE1Ljk4NDQgNS4zNzIyMSAxNi40MjM2IDQuOTg5NjggMTYuNDA1M0M0LjY0NjA5IDE2LjM4ODkgNC4zMzUwNCAxNi4xOTcgNC4xNjYxNyAxNS44OTczQzMuOTc4MTggMTUuNTYzNyA0LjEyODc4IDE0Ljg4NDkgNC40Mjk5NyAxMy41Mjc0TDQuNDg5OTggMTMuMjU2OUM0LjY1Nzk0IDEyLjUgNC43NDE5MSAxMi4xMjE1IDQuNjg5OCAxMS43NTk4QzQuNjU4NTQgMTEuNTQyOCA0LjU5MTgyIDExLjMzMjUgNC40OTIzMiAxMS4xMzcyQzQuMzI2NDUgMTAuODExNSA0LjAzOTY4IDEwLjU1MDYgMy40NjYxMyAxMC4wMjg4TDMuMTI1NDYgOS43MTg5QzEuODk4NjcgOC42MDI3OCAxLjI4NTI3IDguMDQ0NzIgMS4zNjk3NSA3LjUxMTY5QzEuMzg3MjQgNy40MDEzIDEuNDIzMTIgNy4yOTQ2MiAxLjQ3NTg5IDcuMTk2MDhDMS43MzA2OSA2LjcyMDM0IDIuNTY1MDcgNi42NDU2MiA0LjIzMzg0IDYuNDk2MTdDNS4yMTk2MiA2LjQwNzg4IDUuNzEyNTEgNi4zNjM3NCA2LjEwNzM1IDYuMTI1NzZDNi4yMTgxIDYuMDU5MDEgNi4zMjIxMSA1Ljk4MTY4IDYuNDE3OTMgNS44OTQ4NUM2Ljc1OTU0IDUuNTg1MjggNi45NDIxMSA1LjEzMDE0IDcuMzA3MjUgNC4yMTk4NloiIGZpbGw9IiM3M0MwOEEiIHN0cm9rZT0iI0ZGQ0MwMCIgc3Ryb2tlLXdpZHRoPSIyIi8+DQo8L3N2Zz4NCg==\"","import React, {\r\n  ReactElement,\r\n  useCallback,\r\n  useEffect,\r\n  useMemo,\r\n  useState,\r\n} from 'react';\r\nimport { Picker } from 'antd-mobile';\r\nimport { BottomBlank } from '@/components/TabBar/styles';\r\nimport { useLazyQuery } from '@apollo/client';\r\nimport { FIND_RANK } from '@/helpers/APIHelper';\r\nimport { PickValueArr } from '@/pages/Library/utils/stringArrToPickArr';\r\nimport dw from '@/pages/UserCenter/images/avatar-default.jpg';\r\nimport {\r\n  IconArrow,\r\n  ItemFirst,\r\n  ItemSecond,\r\n  ItemThird,\r\n  LadderBox,\r\n  LadderContent,\r\n  RankAvatar,\r\n  RankHeader,\r\n  RankIcon,\r\n  RankItem,\r\n  RankItemCenter,\r\n  RankItemEnd,\r\n  RankItemStart,\r\n  RankList,\r\n  RankName,\r\n  SelectItem,\r\n} from '../styles';\r\nimport { LadderProps, RankItemTypes } from '../types';\r\n\r\nconst Ladder: React.FC<LadderProps> = (props) => {\r\n  const { subjectArr, rankNum, subjectPointsArr } = props;\r\n\r\n  // 获取排行榜数据\r\n  const [getRank, { data: findRankData }] = useLazyQuery(FIND_RANK, {\r\n    fetchPolicy: 'cache-and-network',\r\n  });\r\n  // 排行榜数据\r\n  const rankArr = useMemo(() => {\r\n    return findRankData?.findRank || [];\r\n  }, [findRankData?.findRank]);\r\n  console.log('findRankData++++', rankArr);\r\n  // 选中的排行榜排行数据\r\n  const [rankValue, setRankValue] = useState<string[]>(['']);\r\n  // 筛选的数据类型\r\n  const [rankData, setRankData] = useState<PickValueArr[]>([]);\r\n  const [showMy, setShowmy] = useState(0);\r\n\r\n  // 设置下拉选框展示的值\r\n  const getPointsLabel = (): string => {\r\n    let pointsLabel = '';\r\n    rankData.forEach((item) => {\r\n      if (item.value === rankValue[0]) {\r\n        pointsLabel = item.label;\r\n      }\r\n    });\r\n    return pointsLabel;\r\n  };\r\n  // 获取列表项\r\n  const getRankItem = (): ReactElement[] => {\r\n    return rankArr?.rankSet?.map((item: RankItemTypes, index: number) => {\r\n      const { avatar, rank, userName, point, isHigher } = item;\r\n      return (\r\n        <RankItem className={index + 1 === showMy ? 'my' : ''} key={rank}>\r\n          <ItemFirst>\r\n            <RankItemStart>{rank}</RankItemStart>\r\n          </ItemFirst>\r\n          <ItemSecond pl=\"12px\">\r\n            <RankItemCenter>\r\n              <RankAvatar img={avatar || dw} />\r\n              <RankName>{userName}</RankName>\r\n            </RankItemCenter>\r\n          </ItemSecond>\r\n          <ItemThird>\r\n            <RankItemEnd>\r\n              {point}\r\n              {isHigher > 0 && <RankIcon className=\"iconfont icon-up\" />}\r\n              {isHigher === 0 && (\r\n                <RankIcon className=\"iconfont icon-no-change\" />\r\n              )}\r\n              {isHigher < 0 && <RankIcon className=\"iconfont icon-down\" />}\r\n            </RankItemEnd>\r\n          </ItemThird>\r\n        </RankItem>\r\n      );\r\n    });\r\n  };\r\n\r\n  // 获取当前学科排名\r\n  const getSubjectRank = useCallback(\r\n    (subject: string) => {\r\n      console.log(subjectPointsArr);\r\n      if (subject) {\r\n        subjectPointsArr.forEach((item) => {\r\n          if (item.subject === subject) {\r\n            setShowmy(item.subjectRankThisWeek);\r\n          }\r\n        });\r\n      } else {\r\n        setShowmy(rankNum);\r\n      }\r\n    },\r\n    [rankNum, subjectPointsArr]\r\n  );\r\n  // 获取下拉选框的值\r\n  useEffect(() => {\r\n    console.log('subjectArr+++++++', subjectArr);\r\n    if (subjectArr?.length > 0) {\r\n      const initData = [{ value: '', label: '总分' }, ...subjectArr];\r\n      setRankData(initData);\r\n    }\r\n  }, [subjectArr]);\r\n\r\n  // 学科变更\r\n  useEffect(() => {\r\n    let param = {};\r\n    if (rankValue[0]) {\r\n      param = {\r\n        subject: rankValue[0],\r\n      };\r\n    }\r\n    getSubjectRank(rankValue[0]);\r\n    getRank({\r\n      variables: param,\r\n    });\r\n  }, [getRank, getSubjectRank, rankValue]);\r\n\r\n  return (\r\n    <LadderBox>\r\n      <LadderContent>\r\n        <RankHeader>\r\n          <ItemFirst>排名</ItemFirst>\r\n          <ItemSecond pl=\"100px\">昵称</ItemSecond>\r\n          <ItemThird>\r\n            <Picker\r\n              data={rankData}\r\n              cols={1}\r\n              value={rankValue}\r\n              onOk={(value: string[]): void => setRankValue(value)}\r\n            >\r\n              <SelectItem>\r\n                <span>{getPointsLabel()}</span>\r\n                <IconArrow className=\"iconfont icon-down-arrow\" />\r\n              </SelectItem>\r\n            </Picker>\r\n          </ItemThird>\r\n        </RankHeader>\r\n        <RankList>\r\n          {getRankItem()}\r\n          <BottomBlank />\r\n        </RankList>\r\n      </LadderContent>\r\n    </LadderBox>\r\n  );\r\n};\r\n\r\nexport default Ladder;\r\n","// 根据分数获取等级\r\nconst getLevel = (point: number | string, type: string): string => {\r\n  let level = '';\r\n  if (type === 'math' || type === 'maths1' || type === 'maths2') {\r\n    switch (true) {\r\n      case point < 100:\r\n        level = 'D';\r\n        break;\r\n      case point >= 100 && point < 120:\r\n        level = 'C';\r\n        break;\r\n      case point >= 120 && point < 150:\r\n        level = 'B';\r\n        break;\r\n      case point >= 150 && point < 180:\r\n        level = 'A';\r\n        break;\r\n      case point >= 180:\r\n        level = 'S';\r\n        break;\r\n      default:\r\n    }\r\n  }\r\n  if (type === 'physics' || type === 'chemistry') {\r\n    switch (true) {\r\n      case point < 55:\r\n        level = 'D';\r\n        break;\r\n      case point >= 55 && point < 65:\r\n        level = 'C';\r\n        break;\r\n      case point >= 65 && point < 75:\r\n        level = 'B';\r\n        break;\r\n      case point >= 75 && point < 85:\r\n        level = 'A';\r\n        break;\r\n      case point >= 85:\r\n        level = 'S';\r\n        break;\r\n      default:\r\n    }\r\n  }\r\n  return level;\r\n};\r\n\r\nexport default getLevel;\r\n","import React, { ReactElement, useEffect } from 'react';\r\nimport F2 from '@antv/f2';\r\nimport { Card, WhiteSpace, WingBlank } from 'antd-mobile';\r\nimport { BottomBlank } from '@/components/TabBar/styles';\r\nimport { subjectEnum } from '@/constants/globalDatas';\r\nimport pkg from '../../../../package.json';\r\nimport { RadarScroll, Table, Td, Th, Tr } from '../styles';\r\nimport getLevel from '../utils/getLevel';\r\nimport { RadarProps } from '../types';\r\n\r\nconst themeColor = pkg.theme['brand-primary'];\r\n\r\nconst Radar: React.FC<RadarProps> = (props) => {\r\n  const { subjectPointsArr } = props;\r\n\r\n  useEffect(() => {\r\n    if (subjectPointsArr) {\r\n      const data = subjectPointsArr.map((item) => {\r\n        const { subject, subjectPoint } = item;\r\n        return {\r\n          item: subject,\r\n          score: getLevel(subjectPoint, subject),\r\n        };\r\n      });\r\n      // const data = [\r\n      //   {\r\n      //     item: '英语',\r\n      //     score: 'S',\r\n      //   },\r\n      //   {\r\n      //     item: '日语',\r\n      //     score: 'A',\r\n      //   },\r\n      //   {\r\n      //     item: '数学',\r\n      //     score: 'B',\r\n      //   },\r\n      //   {\r\n      //     item: '物理',\r\n      //     score: 'C',\r\n      //   },\r\n      //   {\r\n      //     item: '化学',\r\n      //     score: 'B',\r\n      //   },\r\n      // ];\r\n      const { width } = window.screen;\r\n      const chart = new F2.Chart<typeof data[0]>({\r\n        id: 'radarChart',\r\n        pixelRatio: window.devicePixelRatio,\r\n        padding: 'auto',\r\n        width,\r\n        height: width * 0.8,\r\n      });\r\n\r\n      chart.coord('polar');\r\n      chart.source(data, {\r\n        score: {\r\n          type: 'cat',\r\n          values: ['D', 'C', 'B', 'A', 'S'],\r\n        },\r\n      });\r\n\r\n      chart.axis('score', {\r\n        label: (text, index, total) => {\r\n          return { top: true, text };\r\n        },\r\n        grid: (text) => {\r\n          return { top: true, text };\r\n        },\r\n        line: {\r\n          top: false,\r\n        },\r\n      });\r\n      chart.axis('item', {\r\n        label: (text, index, total) => {\r\n          return {\r\n            top: true,\r\n            text: subjectEnum[text as keyof typeof subjectEnum],\r\n          };\r\n        },\r\n      });\r\n      chart\r\n        .area()\r\n        .position('item*score')\r\n        .color(`${themeColor}`)\r\n        .animate({\r\n          appear: {\r\n            animation: 'groupWaveIn',\r\n          },\r\n        });\r\n      chart\r\n        .line()\r\n        .position('item*score')\r\n        .color(`${themeColor}`)\r\n        .animate({\r\n          appear: {\r\n            animation: 'groupWaveIn',\r\n          },\r\n        });\r\n      chart\r\n        .point()\r\n        .position('item*score')\r\n        .color(`${themeColor}`)\r\n        .style({\r\n          stroke: '#fff',\r\n          lineWidth: 1,\r\n        })\r\n        .animate({\r\n          appear: {\r\n            delay: 300,\r\n          },\r\n        });\r\n      chart.legend({\r\n        custom: true,\r\n        items: [\r\n          {\r\n            name: '能力现状',\r\n            marker: 'circle',\r\n            fill: themeColor,\r\n          },\r\n        ],\r\n      });\r\n      chart.render();\r\n    }\r\n  }, [subjectPointsArr]);\r\n\r\n  const getTabelData = (): ReactElement => {\r\n    const tableListData: ReactElement[] = [];\r\n    subjectPointsArr?.forEach((item) => {\r\n      const { subject, subjectPoint } = item;\r\n      tableListData.push(\r\n        <Tr key={subject}>\r\n          <Td>{subjectEnum[subject as keyof typeof subjectEnum]}</Td>\r\n          <Td>{subjectPoint}</Td>\r\n          <Td>{getLevel(subjectPoint, subject)}</Td>\r\n        </Tr>\r\n      );\r\n    });\r\n    return (\r\n      <Table>\r\n        <tbody>\r\n          <Tr>\r\n            <Th>科目</Th>\r\n            <Th>预测分数</Th>\r\n            <Th>评级</Th>\r\n          </Tr>\r\n          {tableListData}\r\n        </tbody>\r\n      </Table>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <RadarScroll>\r\n      <canvas id=\"radarChart\" width=\"300\" height=\"300\" />\r\n      <WingBlank size=\"lg\">\r\n        <WhiteSpace size=\"lg\" />\r\n        <Card>\r\n          <Card.Header title=\"数据明细\" />\r\n          <Card.Body>{getTabelData()}</Card.Body>\r\n        </Card>\r\n        <WhiteSpace size=\"lg\" />\r\n      </WingBlank>\r\n      <BottomBlank />\r\n    </RadarScroll>\r\n  );\r\n};\r\n\r\nexport default Radar;\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport F2 from '@antv/f2';\r\nimport PickItem from '@/components/PickItem';\r\nimport { Picker, Toast } from 'antd-mobile';\r\nimport { FIND_TAG, SUBJECT_TAGS_ONLY } from '@/helpers/APIHelper';\r\nimport { useLazyQuery } from '@apollo/client';\r\nimport { PickValueArr } from '@/pages/Library/utils/stringArrToPickArr';\r\nimport { subjectEnum } from '@/constants/globalDatas';\r\nimport getLabelFromValue from '@/utils/getLabelFromValue';\r\nimport { SelectBox, SelectBoxItem } from '../styles';\r\n\r\n// interface SubjectParsingItem {\r\n//   chemistry: { [key: string]: number };\r\n//   math: { [key: string]: number };\r\n//   physicals: { [key: string]: number };\r\n// }\r\n// interface SubjectParsingProps {\r\n//   userInfo?: SubjectParsingItem;\r\n//   generalInfo?: {\r\n//     average?: SubjectParsingItem;\r\n//     top: SubjectParsingItem;\r\n//   };\r\n// }\r\n\r\ninterface SelectData {\r\n  value: string;\r\n  label: string;\r\n}\r\ninterface SubjectParsingProps {\r\n  subjectArr: PickValueArr[];\r\n}\r\n\r\ninterface ChartData {\r\n  date: number;\r\n  type: string;\r\n  value: number;\r\n}\r\n\r\ninterface TagsData {\r\n  _id: string;\r\n  name: string;\r\n  children: {\r\n    _id: string;\r\n    name: string;\r\n  }[];\r\n}\r\n\r\ninterface SourceItem {\r\n  type: string;\r\n  date: number;\r\n  value: number;\r\n}\r\nconst SubjectParsing: React.FC<SubjectParsingProps> = (props) => {\r\n  // 知识点下拉框\r\n  const [pointsData, setPointData] = useState<SelectData[]>([]);\r\n  const [pointsValue, setPointValue] = useState<string[]>(['']);\r\n  // 学科下拉框\r\n  const [subjectvalue, setSubjectValue] = useState<string[]>(['maths1']);\r\n  const [getTags, { data: tags, loading: tagsLoading }] =\r\n    useLazyQuery(SUBJECT_TAGS_ONLY);\r\n  const [getAbilityTag] = useLazyQuery(FIND_TAG, {\r\n    fetchPolicy: 'cache-and-network',\r\n    onCompleted: (res) => handleAbility(res),\r\n  });\r\n  const tagsArrRef = useRef<TagsData[]>([]);\r\n  const chartRef = useRef<any>();\r\n\r\n  const { subjectArr } = props;\r\n  // 选择学科\r\n  const handleSubjectChange = (value: string[]): void => {\r\n    setSubjectValue(value);\r\n  };\r\n  // 变换知识点\r\n  const handlePointsChange = (value: string[]): void => {\r\n    setPointValue(value);\r\n  };\r\n  // 处理返回的分值\r\n  const handleAbility = (data: {\r\n    findAbilityTag: {\r\n      abilityValues: number[];\r\n      tagName: string;\r\n    }[];\r\n  }): void => {\r\n    const { findAbilityTag } = data || {};\r\n    console.log(findAbilityTag);\r\n    const source: SourceItem[] = [];\r\n\r\n    findAbilityTag?.forEach((item) => {\r\n      const { abilityValues, tagName } = item;\r\n      for (let i = 1; i <= 6; i += 1) {\r\n        source.push({\r\n          type: tagName,\r\n          date: i,\r\n          value: abilityValues?.[i] ? Math.round(abilityValues[i] / 20) : 0,\r\n        });\r\n      }\r\n    });\r\n    showParsing(source);\r\n  };\r\n  // 根据学科获得知识点\r\n  useEffect(() => {\r\n    getTags({\r\n      variables: {\r\n        subject: subjectvalue[0],\r\n        sourceType: 'center',\r\n      },\r\n    });\r\n  }, [getTags, subjectvalue]);\r\n\r\n  // 获取知识点\r\n  useEffect(() => {\r\n    const tagsData = tags?.subjectTags?.tags || [];\r\n    const tagsArr =\r\n      tagsData.map((item: { name: string; _id: number }) => {\r\n        const { name, _id } = item;\r\n        return {\r\n          label: name,\r\n          value: _id,\r\n        };\r\n      }) || [];\r\n    setPointValue([tagsArr?.[0]?.value || '']);\r\n    setPointData(tagsArr);\r\n    tagsArrRef.current = tagsData;\r\n  }, [tags?.subjectTags?.tags]);\r\n\r\n  // 切换学科查询知识点loading\r\n  useEffect(() => {\r\n    tagsLoading ? Toast.loading('加载中', 0) : Toast.hide();\r\n  }, [tagsLoading]);\r\n\r\n  // 根据知识点获取相关统计图数据\r\n  useEffect(() => {\r\n    const tagId = pointsValue?.[0];\r\n    if (tagId) {\r\n      getAbilityTag({\r\n        variables: {\r\n          tagId,\r\n        },\r\n      });\r\n    }\r\n  }, [getAbilityTag, pointsValue]);\r\n\r\n  // 监听知识点变化\r\n  // useEffect(() => {\r\n  //   console.log(pointsValue);\r\n  //   const tagsId = pointsValue[0];\r\n  //   // 获取选中tag的子集\r\n  //   if (tagsId) {\r\n  //     tagsArrRef?.current?.forEach((item) => {\r\n  //       if (item._id === tagsId) {\r\n  //         console.log(item.children);\r\n  //         item.children.forEach((item2) => {\r\n  //           getAbilityTag({\r\n  //             variables: {\r\n  //               tagId: item2._id,\r\n  //             },\r\n  //           });\r\n  //         });\r\n  //       }\r\n  //     });\r\n  //   }\r\n  // }, [getAbilityTag, pointsValue]);\r\n  // 展示图表\r\n  const showParsing = (data: ChartData[]): void => {\r\n    const { width } = window.screen;\r\n    const chart = new F2.Chart<typeof data[0]>({\r\n      id: 'columnarChart',\r\n      pixelRatio: window.devicePixelRatio,\r\n      padding: 'auto',\r\n      width,\r\n      height: width * 0.8,\r\n      appendPadding: [15, 15, 15, 20],\r\n    });\r\n    chartRef.current = chart;\r\n    // chart.source(data, {\r\n    //   percent: {\r\n    //     type: 'linear',\r\n    //     alias: '平均正确率(%)',\r\n    //     min: 0,\r\n    //     max: 100,\r\n    //     tickCount: 6,\r\n    //   },\r\n    // });\r\n\r\n    // chart.interval().position('genre*percent').color('genre');\r\n    // chart.legend({\r\n    //   align: 'right',\r\n    //   itemWidth: null,\r\n    // });\r\n    // chart.guide().text({\r\n    //   position: ['min', 'max'],\r\n    //   content: '平均正确率(%)',\r\n    //   style: {\r\n    //     textBaseline: 'middle',\r\n    //   },\r\n    //   offsetY: -35,\r\n    // });\r\n    // chart.render();\r\n    // const offset = -5;\r\n    // const canvas = chart.get('canvas');\r\n    // const group = canvas.addGroup();\r\n    // data.forEach((obj) => {\r\n    //   const point = chart.getPosition(obj);\r\n    //   group.addShape('text', {\r\n    //     attrs: {\r\n    //       x: point.x,\r\n    //       y: point.y + offset,\r\n    //       text: `${obj.percent}%`,\r\n    //       textAlign: 'center',\r\n    //       textBaseline: 'bottom',\r\n    //       fill: '#808080',\r\n    //     },\r\n    //   });\r\n    // });\r\n    chart.source(data);\r\n    chart.scale('date', {\r\n      ticks: ['1', '2', '3', '4', '5', '6'],\r\n    });\r\n    chart.scale('value', {\r\n      ticks: ['0', '1', '2', '3', '4', '5'],\r\n    });\r\n    chart.axis('date', {\r\n      label: function label(text, index, total) {\r\n        return {\r\n          text: `第${text}月`,\r\n        };\r\n      },\r\n    });\r\n    chart.axis('value', {\r\n      label: function label(text, index, total) {\r\n        return {\r\n          text: `${text}星`,\r\n        };\r\n      },\r\n    });\r\n    chart.line().position('date*value').color('type');\r\n    chart.point().position('date*value').color('type');\r\n    chart.render();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <SelectBox>\r\n        <SelectBoxItem>\r\n          <Picker\r\n            data={subjectArr}\r\n            cols={1}\r\n            onOk={handleSubjectChange}\r\n            value={subjectvalue}\r\n          >\r\n            <PickItem\r\n              placeholder=\"请选择科目\"\r\n              value={subjectEnum[subjectvalue[0] as keyof typeof subjectEnum]}\r\n            />\r\n          </Picker>\r\n        </SelectBoxItem>\r\n        <SelectBoxItem>\r\n          <Picker\r\n            data={pointsData}\r\n            cols={1}\r\n            onOk={handlePointsChange}\r\n            value={pointsValue}\r\n          >\r\n            <PickItem\r\n              placeholder=\"请选择知识点\"\r\n              value={getLabelFromValue(pointsData, pointsValue[0] || '')}\r\n            />\r\n          </Picker>\r\n        </SelectBoxItem>\r\n      </SelectBox>\r\n      <canvas id=\"columnarChart\" />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SubjectParsing;\r\n","import React from 'react';\r\nimport { Tabs } from 'antd-mobile';\r\nimport Radar from './Radar';\r\nimport SubjectParsing from './SubjectParsing';\r\nimport { StrengthProps } from '../types';\r\n\r\nconst Strength: React.FC<StrengthProps> = (props) => {\r\n  const { subjectArr, subjectPointsArr, handleStrengthTabChang, strengthTab } =\r\n    props;\r\n  const handleTabChange = (index: number): void => {\r\n    handleStrengthTabChang(index);\r\n  };\r\n  return (\r\n    <Tabs\r\n      tabs={[\r\n        { title: '综合雷达图', sub: '1' },\r\n        { title: '学科/知识点能力分析', sub: '2' },\r\n      ]}\r\n      page={strengthTab}\r\n      onChange={(tab, index): void => handleTabChange(index)}\r\n    >\r\n      <Radar subjectPointsArr={subjectPointsArr} />\r\n      <SubjectParsing subjectArr={subjectArr} />\r\n    </Tabs>\r\n  );\r\n};\r\n\r\nexport default Strength;\r\n","import React, { ReactElement, useEffect, useState } from 'react';\r\nimport F2 from '@antv/f2';\r\nimport { Card, Picker, WhiteSpace, WingBlank } from 'antd-mobile';\r\nimport PickItem from '@/components/PickItem';\r\nimport { BottomBlank } from '@/components/TabBar/styles';\r\nimport APIHelper from '@/helpers/APIHelper';\r\nimport getGoalSchool, { PickDataItem, getSubject } from '@/utils/getGoalSchool';\r\nimport { RecommendPointAbility, SchoolData } from '@/helpers/types';\r\nimport { subjectEnum } from '@/constants/globalDatas';\r\nimport pkg from '../../../../package.json';\r\nimport {\r\n  PredictBox,\r\n  PredictBoxButton,\r\n  PredictBoxFont,\r\n  PredictScroll,\r\n  PredictSelect,\r\n  Table,\r\n  Td,\r\n  Th,\r\n  Tr,\r\n} from '../styles';\r\nimport getLevel from '../utils/getLevel';\r\nimport { PredictProps } from '../types';\r\n\r\nconst themeColor = pkg.theme['brand-primary'];\r\n\r\nconst Predict: React.FC<PredictProps> = (props) => {\r\n  const [school, setSchool] = useState<string[]>([]);\r\n  const [totalData, setTotalData] = useState<SchoolData>({});\r\n  const [goalSchool, setGoalSchool] = useState<PickDataItem[]>([]); // 学校列表\r\n  const [ejuSubject, setEjuSubject] = useState<PickDataItem[]>([]); // 专业\r\n  const [department, setDepartment] = useState<string[]>([]); // 专业\r\n  const [probability, setProbability] = useState(0); // 合格率\r\n  const [recommendPoint, setRecommendPoint] = useState<RecommendPointAbility>({\r\n    english: '',\r\n    jap: 0,\r\n    jap_writing: 0,\r\n    math: 0,\r\n    physics: 0,\r\n    chemistry: 0,\r\n  }); // 推荐能力值\r\n  const { subjectPointsArr } = props;\r\n\r\n  useEffect(() => {\r\n    if (subjectPointsArr || recommendPoint) {\r\n      const recommendPointData = { ...recommendPoint };\r\n      const data: { [key: string]: string }[] = [];\r\n      subjectPointsArr?.forEach((item) => {\r\n        const { subject, subjectPoint } = item;\r\n        data.push({\r\n          item: subject,\r\n          type: 'my',\r\n          score: getLevel(subjectPoint, subject),\r\n        });\r\n      });\r\n      Object.keys(recommendPointData).forEach((item) => {\r\n        console.log('recommendPointData+++++++item', item);\r\n        data.push({\r\n          item,\r\n          type: 'you',\r\n          score:\r\n            item === 'english'\r\n              ? recommendPointData[item]\r\n              : getLevel(\r\n                  recommendPointData[item as keyof typeof recommendPointData],\r\n                  item\r\n                ),\r\n        });\r\n      });\r\n      // const data = [\r\n      //   {\r\n      //     item: '英语',\r\n      //     type: 'my',\r\n      //     score: 'S',\r\n      //   },\r\n      //   {\r\n      //     item: '日语',\r\n      //     type: 'my',\r\n      //     score: 'A+',\r\n      //   },\r\n      //   {\r\n      //     item: '数学',\r\n      //     type: 'my',\r\n      //     score: 'B+',\r\n      //   },\r\n      //   {\r\n      //     item: '物理',\r\n      //     type: 'my',\r\n      //     score: 'C+',\r\n      //   },\r\n      //   {\r\n      //     item: '化学',\r\n      //     type: 'my',\r\n      //     score: 'A-',\r\n      //   },\r\n      //   {\r\n      //     item: '英语',\r\n      //     type: 'you',\r\n      //     score: 'B+',\r\n      //   },\r\n      //   {\r\n      //     item: '日语',\r\n      //     type: 'you',\r\n      //     score: 'C-',\r\n      //   },\r\n      //   {\r\n      //     item: '数学',\r\n      //     type: 'you',\r\n      //     score: 'A+',\r\n      //   },\r\n      //   {\r\n      //     item: '物理',\r\n      //     type: 'you',\r\n      //     score: 'A+',\r\n      //   },\r\n      //   {\r\n      //     item: '化学',\r\n      //     type: 'you',\r\n      //     score: 'B-',\r\n      //   },\r\n      // ];\r\n      const { width } = window.screen;\r\n      const chart = new F2.Chart<typeof data[0]>({\r\n        id: 'predictChart',\r\n        pixelRatio: window.devicePixelRatio,\r\n        padding: 30,\r\n        width,\r\n        height: width * 0.8,\r\n        appendPadding: [15, 15, 15, 20],\r\n      });\r\n\r\n      chart.coord('polar');\r\n      chart.source(data, {\r\n        score: {\r\n          type: 'cat',\r\n          values: ['D', 'C', 'B', 'A', 'S'],\r\n        },\r\n      });\r\n\r\n      chart.axis('score', {\r\n        label: (text, index, total) => {\r\n          console.log('label++++++score', text, index, total);\r\n          return { top: true, text };\r\n        },\r\n        grid: (text) => {\r\n          console.log(text);\r\n          return { top: true, text };\r\n        },\r\n        line: {\r\n          top: false,\r\n        },\r\n      });\r\n      chart.axis('item', {\r\n        label: (text, index, total) => {\r\n          console.log('label++++++item', text, index, total);\r\n          return {\r\n            top: true,\r\n            text: subjectEnum[text as keyof typeof subjectEnum],\r\n          };\r\n        },\r\n      });\r\n      chart\r\n        .area()\r\n        .position('item*score')\r\n        .color('type', (type) => {\r\n          console.log(type);\r\n          if (type === 'my') {\r\n            return themeColor;\r\n          }\r\n          return '#BFBFBF';\r\n        })\r\n        .animate({\r\n          appear: {\r\n            animation: 'groupWaveIn',\r\n          },\r\n        });\r\n      chart\r\n        .line()\r\n        .position('item*score')\r\n        .color('type', (type) => {\r\n          console.log(type);\r\n          if (type === 'my') {\r\n            return themeColor;\r\n          }\r\n          return '#BFBFBF';\r\n        })\r\n        .animate({\r\n          appear: {\r\n            animation: 'groupWaveIn',\r\n          },\r\n        });\r\n      chart\r\n        .point()\r\n        .position('item*score')\r\n        .color('type', (type) => {\r\n          console.log(type);\r\n          if (type === 'my') {\r\n            return themeColor;\r\n          }\r\n          return '#BFBFBF';\r\n        })\r\n        .style({\r\n          stroke: '#fff',\r\n          lineWidth: 1,\r\n        })\r\n        .animate({\r\n          appear: {\r\n            delay: 300,\r\n          },\r\n        });\r\n      chart.legend({\r\n        custom: true,\r\n        verticalAlign: 'top',\r\n        position: 'left',\r\n        items: [\r\n          {\r\n            name: '能力现状',\r\n            marker: 'circle',\r\n            fill: themeColor,\r\n          },\r\n          {\r\n            name: '能力目标',\r\n            marker: 'circle',\r\n            fill: '#BFBFBF',\r\n          },\r\n        ],\r\n      });\r\n      chart.render();\r\n    }\r\n  }, [recommendPoint, subjectPointsArr]);\r\n  const getTabelData = (): ReactElement => {\r\n    const recommendPointData = { ...recommendPoint };\r\n    const tableListData: ReactElement[] = [];\r\n    const sourceData = {} as {\r\n      [key: string]: {\r\n        point?: number;\r\n        level?: string;\r\n        goalPoint?: number;\r\n        goalLevel?: string;\r\n      };\r\n    };\r\n    subjectPointsArr?.forEach((item) => {\r\n      const { subject, subjectPoint } = item;\r\n      if (!sourceData[subject]) {\r\n        sourceData[subject] = {};\r\n      }\r\n      sourceData[subject].point = subjectPoint;\r\n      sourceData[subject].level = getLevel(subjectPoint, subject);\r\n    });\r\n    Object.keys(recommendPointData).forEach((item) => {\r\n      if (!sourceData[item]) {\r\n        sourceData[item] = {};\r\n      }\r\n      let point = 0;\r\n      if (item === 'english') {\r\n        // point = recommendPointData[item as keyof typeof recommendPointData].toefl;\r\n        // 接口没有英语成绩\r\n        point = 0;\r\n      } else {\r\n        point = Number(\r\n          recommendPointData[item as keyof typeof recommendPointData]\r\n        );\r\n      }\r\n      console.log('sourceData+++', sourceData);\r\n\r\n      sourceData[item].goalPoint = point;\r\n      sourceData[item].goalLevel = getLevel(point, item);\r\n    });\r\n    Object.keys(sourceData).forEach((item) => {\r\n      const itemData = sourceData[item];\r\n      const { point, level, goalPoint, goalLevel } = itemData;\r\n      tableListData.push(\r\n        <Tr key={item}>\r\n          <Td>{subjectEnum[item as keyof typeof subjectEnum]}</Td>\r\n          <Td>{point}</Td>\r\n          <Td>{goalPoint}</Td>\r\n          <Td>{level}</Td>\r\n          <Td>{goalLevel}</Td>\r\n        </Tr>\r\n      );\r\n    });\r\n    return (\r\n      <Table>\r\n        <tbody>\r\n          <Tr>\r\n            <Th>科目</Th>\r\n            <Th>预测分数</Th>\r\n            <Th>目标分数</Th>\r\n            <Th>评级</Th>\r\n            <Th>目标评级</Th>\r\n          </Tr>\r\n          {tableListData}\r\n        </tbody>\r\n      </Table>\r\n    );\r\n  };\r\n  // 选择学校\r\n  const handleSchool = (value: string[]): void => {\r\n    console.log(value, 'value+++');\r\n\r\n    const subjectArr = getSubject(\r\n      totalData[Number(value[0]) as keyof typeof totalData].departments\r\n    );\r\n    setEjuSubject(subjectArr);\r\n    setSchool(value);\r\n    setDepartment([]);\r\n  };\r\n\r\n  // 点击预测\r\n  const handlePredict = (): void => {\r\n    const param = {\r\n      school_id: Number(school[0]),\r\n      math: 200,\r\n      ja: 400,\r\n      phy: 90,\r\n      che: 100,\r\n      jaw: 50,\r\n      department: department[0],\r\n    };\r\n    APIHelper.predict(param).then((res) => {\r\n      console.log(res.code);\r\n      if (res.code === 204) {\r\n        setProbability(res.data.probability);\r\n        setRecommendPoint(res.data.recommendPoint.ability);\r\n      }\r\n    });\r\n  };\r\n  useEffect(() => {\r\n    APIHelper.getSchool().then((res) => {\r\n      setTotalData(res.data);\r\n      const filterArr = getGoalSchool(res.data);\r\n      setGoalSchool(filterArr);\r\n    });\r\n  }, []);\r\n  return (\r\n    <PredictScroll>\r\n      <PredictSelect>\r\n        <WhiteSpace size=\"lg\" />\r\n        <Picker\r\n          data={goalSchool}\r\n          cols={1}\r\n          onOk={(value): void => handleSchool(value)}\r\n        >\r\n          <PickItem\r\n            placeholder=\"院校\"\r\n            value={\r\n              totalData[Number(school[0]) as keyof typeof totalData]?.schoolName\r\n            }\r\n          />\r\n        </Picker>\r\n\r\n        <Picker\r\n          data={ejuSubject}\r\n          cols={1}\r\n          onOk={(value): void => setDepartment(value)}\r\n        >\r\n          <PickItem placeholder=\"专业\" value={department[0]} />\r\n        </Picker>\r\n      </PredictSelect>\r\n\r\n      <PredictBox>\r\n        <PredictBoxFont>\r\n          合格概率:（{(probability * 100).toFixed(2)}%）\r\n        </PredictBoxFont>\r\n        <PredictBoxButton onClick={(): void => handlePredict()}>\r\n          点击预测\r\n        </PredictBoxButton>\r\n      </PredictBox>\r\n      <canvas id=\"predictChart\" width=\"300\" height=\"300\" />\r\n      <WingBlank size=\"lg\">\r\n        <WhiteSpace size=\"lg\" />\r\n        <Card>\r\n          <Card.Header title=\"数据明细\" />\r\n          <Card.Body>{getTabelData()}</Card.Body>\r\n        </Card>\r\n        <WhiteSpace size=\"lg\" />\r\n      </WingBlank>\r\n      <BottomBlank />\r\n    </PredictScroll>\r\n  );\r\n};\r\n\r\nexport default Predict;\r\n","import React, {\r\n  ReactNode,\r\n  useCallback,\r\n  useEffect,\r\n  useMemo,\r\n  useState,\r\n} from 'react';\r\nimport {\r\n  FIND_GENERAL_ABILITY,\r\n  FIND_SUBJECT,\r\n  PREDICTED_POINTS,\r\n  QUERY_SUBJECT,\r\n  USER_SHOW,\r\n} from '@/helpers/APIHelper';\r\nimport { useQuery } from '@apollo/client';\r\nimport { level, subjectEnum } from '@/constants/globalDatas';\r\nimport Ladder from './Ladder';\r\nimport Strength from './Strength';\r\nimport Predict from './Predict';\r\nimport {\r\n  IconStar,\r\n  InfoBox,\r\n  InfoItem,\r\n  InfoLi,\r\n  Page,\r\n  TabBox,\r\n  TabItem,\r\n} from './styles';\r\nimport stringArrToPickArr, {\r\n  PickValueArr,\r\n} from '../Library/utils/stringArrToPickArr';\r\n\r\nconst Find: React.FC = () => {\r\n  const { data = {} } = useQuery(USER_SHOW);\r\n  const { data: generalAbility = 0 } = useQuery(FIND_GENERAL_ABILITY);\r\n  // 获取学科下拉框\r\n  const { data: sujectData } = useQuery(QUERY_SUBJECT, {\r\n    variables: { sourceType: 'center' },\r\n  });\r\n  // 获取发现相关学科\r\n  const { data: findSujectData } = useQuery(FIND_SUBJECT);\r\n  // 返回预测总分数和学科预测分数\r\n  const { data: predicterPoints } = useQuery(PREDICTED_POINTS);\r\n  console.log(predicterPoints, 'predicterPoints+++++');\r\n  const { totalRankThisWeek, findPointsSubject, totalPoint } =\r\n    predicterPoints?.findPredictedPoints || {};\r\n  // 学科数组\r\n  const subjectArr = useMemo(\r\n    () => sujectData?.typeSubjects || [],\r\n    [sujectData?.typeSubjects]\r\n  );\r\n  // 发现学科数组\r\n  const findSubjectArr = useMemo(\r\n    () => findSujectData?.findSubjects || [],\r\n    [findSujectData?.findSubjects]\r\n  );\r\n  // 能力值\r\n  const abilityValue = Math.round(generalAbility?.findGeneralAbility / 20);\r\n  const [tabType, setTabType] = useState('strength'); // tab标签类型\r\n  const [rankNum, setRankNum] = useState(0); // 设置排名\r\n  const [subjectFilterArr, setSubjectFilterArr] = useState<PickValueArr[]>([]); // 学科下拉框数据\r\n  const [findSubjectFilterArr, setFindSubjectFilterArr] = useState<\r\n    PickValueArr[]\r\n  >([]); // 发现学科下拉框数据\r\n  const [strengthTab, setStrengthTab] = useState(0);\r\n  // 切换tab标签\r\n  const handleTabChange = (type: string): void => {\r\n    setTabType(type);\r\n  };\r\n  // 获取返回的标签内容\r\n  const getTabContent = useCallback((): ReactNode => {\r\n    let ele = null;\r\n    switch (tabType) {\r\n      case 'strength':\r\n        ele = (\r\n          <Strength\r\n            subjectArr={subjectFilterArr}\r\n            subjectPointsArr={findPointsSubject}\r\n            handleStrengthTabChang={handleStrengthTabChang}\r\n            strengthTab={strengthTab}\r\n          />\r\n        );\r\n        break;\r\n      case 'ladder':\r\n        ele = (\r\n          <Ladder\r\n            subjectArr={findSubjectFilterArr}\r\n            rankNum={rankNum}\r\n            subjectPointsArr={findPointsSubject}\r\n          />\r\n        );\r\n        break;\r\n      case 'predict':\r\n        ele = <Predict subjectPointsArr={findPointsSubject} />;\r\n        break;\r\n      default:\r\n    }\r\n    return ele;\r\n  }, [\r\n    findPointsSubject,\r\n    findSubjectFilterArr,\r\n    rankNum,\r\n    strengthTab,\r\n    subjectFilterArr,\r\n    tabType,\r\n  ]);\r\n\r\n  const { nickName } = data?.getUserInfo || {};\r\n\r\n  // 获取菓星值展示\r\n  const getStar = useCallback(() => {\r\n    const starArr = [];\r\n    for (let i = 1; i <= 5; i += 1) {\r\n      starArr.push(\r\n        <IconStar\r\n          className={i <= abilityValue ? 'iconfont icon-star1' : ''}\r\n          key={i}\r\n        />\r\n      );\r\n    }\r\n    return starArr;\r\n  }, [abilityValue]);\r\n\r\n  // 获得信息展示栏\r\n  const getInfo = useCallback((): JSX.Element => {\r\n    const Item1 = <InfoItem>昵称：{nickName}</InfoItem>;\r\n    let Item2 = null;\r\n    let Item3 = null;\r\n    let Item4 = null;\r\n    switch (tabType) {\r\n      case 'strength':\r\n        if (strengthTab === 0) {\r\n          Item2 = <InfoItem>预测分数(不含日语)</InfoItem>;\r\n          Item4 = <InfoItem>{totalPoint}</InfoItem>;\r\n        }\r\n        if (strengthTab === 1) {\r\n          Item2 = <InfoItem>平均菓星值</InfoItem>;\r\n          Item4 = <InfoItem>{getStar()}</InfoItem>;\r\n        }\r\n        Item3 = (\r\n          <InfoItem>\r\n            评级：\r\n            {level[abilityValue as keyof typeof level]}\r\n          </InfoItem>\r\n        );\r\n        break;\r\n      case 'ladder':\r\n        Item2 = <InfoItem>本季综合排名</InfoItem>;\r\n        Item3 = <InfoItem>总分：{totalPoint}</InfoItem>;\r\n        Item4 = <InfoItem>{rankNum}</InfoItem>;\r\n        break;\r\n      case 'predict':\r\n        Item2 = <InfoItem>预测分数(不含日语)</InfoItem>;\r\n        Item3 = (\r\n          <InfoItem>\r\n            评级：\r\n            {level[abilityValue as keyof typeof level]}\r\n          </InfoItem>\r\n        );\r\n        Item4 = <InfoItem>{totalPoint}</InfoItem>;\r\n        break;\r\n      default:\r\n    }\r\n    return (\r\n      <InfoBox>\r\n        <InfoLi>\r\n          {Item1}\r\n          {Item2}\r\n        </InfoLi>\r\n        <InfoLi>\r\n          {Item3}\r\n          {Item4}\r\n        </InfoLi>\r\n      </InfoBox>\r\n    );\r\n  }, [\r\n    abilityValue,\r\n    getStar,\r\n    nickName,\r\n    rankNum,\r\n    strengthTab,\r\n    tabType,\r\n    totalPoint,\r\n  ]);\r\n  // 实力评估tab切换\r\n  const handleStrengthTabChang = (index: number): void => {\r\n    console.log(index);\r\n    setStrengthTab(index);\r\n  };\r\n  // 获取下拉选框的值\r\n  useEffect(() => {\r\n    if (subjectArr?.length > 0) {\r\n      setSubjectFilterArr(stringArrToPickArr(subjectArr, subjectEnum));\r\n    }\r\n  }, [subjectArr]);\r\n  // 获取发现学科下拉选框的值\r\n  useEffect(() => {\r\n    if (findSubjectArr?.length > 0) {\r\n      setFindSubjectFilterArr(stringArrToPickArr(findSubjectArr, subjectEnum));\r\n    }\r\n  }, [findSubjectArr]);\r\n  // 设置综合排行\r\n  useEffect(() => {\r\n    setRankNum(totalRankThisWeek);\r\n  }, [totalRankThisWeek]);\r\n  return (\r\n    <Page>\r\n      <TabBox>\r\n        <TabItem\r\n          className={tabType === 'strength' ? 'active' : ''}\r\n          onClick={(): void => handleTabChange('strength')}\r\n        >\r\n          实力评估\r\n        </TabItem>\r\n        <TabItem\r\n          className={tabType === 'ladder' ? 'active' : ''}\r\n          onClick={(): void => handleTabChange('ladder')}\r\n        >\r\n          排行天梯\r\n        </TabItem>\r\n        <TabItem\r\n          className={tabType === 'predict' ? 'active' : ''}\r\n          onClick={(): void => handleTabChange('predict')}\r\n        >\r\n          智能预测\r\n        </TabItem>\r\n      </TabBox>\r\n      <>{getInfo()}</>\r\n      <>{getTabContent()}</>\r\n    </Page>\r\n  );\r\n};\r\n\r\nexport default Find;\r\n","export default __webpack_public_path__ + \"assets/images/bg677958d2.jpg\";","import styled from 'styled-px2vw';\r\nimport bg from './images/bg.jpg';\r\nimport pkg from '../../../package.json';\r\n\r\nconst themeColor = pkg.theme['brand-primary'];\r\n\r\nexport const PersonBg = styled.div`\r\n  height: 312px;\r\n  position: relative;\r\n`;\r\nexport const PersonInner = styled.div`\r\n  position: absolute;\r\n  z-index: 2;\r\n  width: 100%;\r\n  height: 100%;\r\n`;\r\nexport const PersonBgInner = styled(PersonInner)<{ bg: string }>`\r\n  z-index: 1;\r\n  overflow: hidden;\r\n  &::before {\r\n    content: '';\r\n    position: absolute;\r\n    background-repeat: no-repeat;\r\n    background-position: center;\r\n    background-image: url(${(props): string => props.bg});\r\n    filter: blur(10px);\r\n    background-size: cover;\r\n    width: 115%;\r\n    height: 115%;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n  }\r\n`;\r\nexport const AvatarBox = styled.div`\r\n  width: 220px;\r\n  height: 220px;\r\n  border-radius: 50%;\r\n  background-color: #fff;\r\n  padding: 12px;\r\n  position: absolute;\r\n  left: 42px;\r\n  bottom: -14px;\r\n  box-shadow: 0px 4px 20px rgba(101, 101, 101, 0.15);\r\n`;\r\nexport const Avatar = styled.img`\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 50%;\r\n  object-fit: cover;\r\n  object-position: center;\r\n`;\r\nexport const AvatarUpload = styled.input`\r\n  width: 100%;\r\n  height: 100%;\r\n  opacity: 0;\r\n  position: absolute;\r\n  z-index: 1;\r\n  top: 0;\r\n  left: 0;\r\n`;\r\nexport const NickBox = styled.div`\r\n  width: 375px;\r\n  height: 206px;\r\n  position: absolute;\r\n  right: 0;\r\n  bottom: 0;\r\n  color: #fff;\r\n`;\r\n\r\nexport const NickName = styled.div`\r\n  font-weight: bold;\r\n  font-size: 38px;\r\n`;\r\nexport const Sign = styled.div`\r\n  font-size: 22px;\r\n  margin-top: 70px;\r\n`;\r\n\r\nexport const FucList = styled.div`\r\n  height: 366px;\r\n  background: #f5f5f5;\r\n  display: flex;\r\n  align-items: center;\r\n  width: 100%;\r\n  overflow: auto;\r\n`;\r\n\r\nexport const FucListItem = styled.div`\r\n  width: 284px;\r\n  height: 234px;\r\n  background: #fff;\r\n  filter: drop-shadow(4px 5px 10px rgba(0, 0, 0, 0.05));\r\n  border-radius: 20px;\r\n  margin-left: 32px;\r\n  flex-shrink: 0;\r\n  &:last-child {\r\n    margin-right: 32px;\r\n  }\r\n`;\r\n\r\nexport const FucListItemTop = styled.div`\r\n  height: 134px;\r\n  background: url(${bg}) no-repeat center;\r\n  background-size: cover;\r\n  border-top-left-radius: 20px;\r\n  border-top-right-radius: 20px;\r\n`;\r\nexport const FucListItemBottom = styled.div`\r\n  height: 100px;\r\n  font-size: 32px;\r\n  font-weight: bold;\r\n  text-align: center;\r\n  line-height: 100px;\r\n`;\r\n\r\nexport const MenuBox = styled.div`\r\n  padding-top: 60px;\r\n`;\r\n\r\nexport const MenuItem = styled.div`\r\n  padding: 0 46px;\r\n  display: flex;\r\n  align-items: center;\r\n  height: 96px;\r\n  margin-bottom: 36px;\r\n  justify-content: space-between;\r\n`;\r\n\r\nexport const MenuLabel = styled.div`\r\n  display: inline-flex;\r\n  font-weight: bold;\r\n  font-size: 32px;\r\n  align-items: center;\r\n`;\r\n\r\nexport const MenuIcon = styled.span`\r\n  width: 40px;\r\n  height: 40px;\r\n  margin-right: 90px;\r\n  font-size: 40px;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: #bfbfbf;\r\n`;\r\n\r\nexport const MsgNum = styled.div`\r\n  width: 48px;\r\n  height: 48px;\r\n  border-radius: 6px;\r\n  background: ${themeColor};\r\n  font-weight: 500;\r\n  font-size: 14px;\r\n  font-size: 28px;\r\n  line-height: 48px;\r\n  text-align: center;\r\n  color: #fff;\r\n`;\r\n","import EXIF from './exif';\n// 校验图片格式\nconst checkImg = (file: File): boolean => {\n  return /\\.(png|jpg|jpeg|PNG|JPG|JPEG)$/.test(file.name);\n};\n\n// 获取图片的旋转数值\nfunction getPhotoOrientation(img: HTMLImageElement): number {\n  let orient = 0;\n  try {\n    EXIF.getData(img, (): void => {\n      orient = EXIF.getTag(img, 'Orientation');\n    });\n  } catch (e) {\n    console.log(e);\n  }\n  return orient;\n}\n// 图片压缩\nfunction compressImg(imgBase64: string, sizeNum: number): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d');\n    const img = new Image();\n    img.src = imgBase64;\n\n    img.onerror = (): void => {\n      reject(new Error('上传失败！'));\n    };\n    img.onload = (): void => {\n      const { width } = img;\n      const { height } = img;\n      const scale = width / height;\n      // let w = 600;\n      // let h = parseInt(w / scale);\n      let w = 0;\n      let h = 0;\n      const baseNum = sizeNum;\n      if (scale < 1) {\n        w = baseNum;\n        h = baseNum / scale;\n      } else {\n        h = baseNum;\n        w = scale * baseNum;\n      }\n      // 解决ios中压缩图片后旋转Bug\n      console.log('orient:', getPhotoOrientation(img));\n      const orient = getPhotoOrientation(img);\n      if (context) {\n        switch (orient) {\n          case 6:\n            canvas.width = h;\n            canvas.height = w;\n            context.save();\n            context.translate(h / 2, w / 2);\n            context.rotate((90 * Math.PI) / 180);\n            context.drawImage(img, -w / 2, -h / 2, w, h);\n            context.restore();\n            break;\n          case 3:\n            canvas.width = w;\n            canvas.height = h;\n            context.save();\n            context.translate(w / 2, h / 2);\n            context.rotate((180 * Math.PI) / 180);\n            context.drawImage(img, -w / 2, -h / 2, w, h);\n            context.restore();\n            break;\n          case 8:\n            canvas.width = h;\n            canvas.height = w;\n            context.save();\n            context.translate(h / 2, w / 2);\n            context.rotate((-90 * Math.PI) / 180);\n            context.drawImage(img, -w / 2, -h / 2, w, h);\n            context.restore();\n            break;\n          default:\n            canvas.width = w;\n            canvas.height = h;\n            context.drawImage(img, 0, 0, w, h);\n        }\n      }\n      const imgCompressed = canvas.toDataURL('image/jpeg', 0.92);\n      resolve(imgCompressed);\n    };\n  });\n}\nconst chooseImg = (file: File, sizeNum: number): Promise<string> => {\n  return new Promise((resolve, reject) => {\n    if (!checkImg(file)) {\n      reject(new Error('请上传正确格式图片（jpeg、jpg、png）'));\n    }\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    // 获取图片base64资源\n    reader.onload = (e): void => {\n      // console.log(e && e.target && e.target.result);\n      const imageBase64 =\n        e && e.target && e.target.result ? e.target.result : '';\n      const imageBase64String =\n        typeof imageBase64 === 'string' ? imageBase64 : '';\n      compressImg(imageBase64String, sizeNum)\n        .then((res) => resolve(res))\n        .catch((pressError) => reject(pressError));\n    };\n    reader.onerror = (): void => {\n      reject(new Error('上传失败！'));\n    };\n  });\n};\nexport default chooseImg;\n","import React, { useContext, useEffect, useState } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { useMutation, useQuery } from '@apollo/client';\r\nimport {\r\n  QUERY_MSG_NUM,\r\n  UPDATE_USER_INFO,\r\n  USER_SHOW,\r\n} from '@/helpers/APIHelper';\r\nimport { ProviderContext } from '@/reducer/context';\r\nimport {\r\n  PersonBg,\r\n  AvatarBox,\r\n  PersonInner,\r\n  Avatar,\r\n  PersonBgInner,\r\n  NickBox,\r\n  NickName,\r\n  Sign,\r\n  FucList,\r\n  FucListItem,\r\n  FucListItemTop,\r\n  FucListItemBottom,\r\n  MenuBox,\r\n  MenuItem,\r\n  MenuLabel,\r\n  MenuIcon,\r\n  MsgNum,\r\n  AvatarUpload,\r\n} from './styles';\r\nimport chooseImg from './utils/chooseImg';\r\nimport avatarDefault from './images/avatar-default.jpg';\r\n\r\nconst UserCenter: React.FC = () => {\r\n  const { data = {} } = useQuery(USER_SHOW, {\r\n    fetchPolicy: 'cache-and-network',\r\n  });\r\n  const { data: msgNum } = useQuery(QUERY_MSG_NUM, {\r\n    fetchPolicy: 'cache-and-network',\r\n  });\r\n  const { state } = useContext(ProviderContext);\r\n  const { userInfo } = state;\r\n  const { nickName, signature, avatar } = data?.getUserInfo || userInfo || {};\r\n  const [avatarBase64, setAvatarBase64] = useState(avatar || '');\r\n  const [updateUserInfo] = useMutation(UPDATE_USER_INFO, {\r\n    onCompleted: () => console.log('保存成功'),\r\n    onError: () => console.log('保存失败'),\r\n  });\r\n\r\n  const history = useHistory();\r\n  const avatarStr = avatarBase64 || avatarDefault;\r\n\r\n  console.log('avatarStr+++++', avatarStr);\r\n  // 操作菜单\r\n  const handleMenu = (type: string): void => {\r\n    switch (type) {\r\n      case 'msg':\r\n        history.push('/msg');\r\n        break;\r\n      case 'personal':\r\n        history.push('/complete-all?completeType=update');\r\n        break;\r\n      case 'setting':\r\n        history.push('/setting');\r\n        break;\r\n      default:\r\n    }\r\n  };\r\n  // 获取未读消息数\r\n  // const getMessageNum = (): number => {\r\n  //   let num = 0;\r\n  //   userMessages?.forEach((item: { isRead: boolean }) => {\r\n  //     if (!item.isRead) {\r\n  //       num += 1;\r\n  //     }\r\n  //   });\r\n  //   return num;\r\n  // };\r\n\r\n  // 上传头像\r\n  const getImg = (e: React.ChangeEvent<HTMLInputElement>): void => {\r\n    const fileData = e.target.files;\r\n    if (fileData && fileData[0]) {\r\n      // 获取图片最小大小像素\r\n      const sizeNum =\r\n        (document.getElementById('avatar_box')?.offsetWidth || 0) *\r\n        window.devicePixelRatio;\r\n      chooseImg(fileData[0], sizeNum).then((res) => {\r\n        updateUserInfo({\r\n          variables: {\r\n            userInfoInput: {\r\n              avatar: res,\r\n            },\r\n          },\r\n        });\r\n        setAvatarBase64(res);\r\n        console.log(res);\r\n      });\r\n    }\r\n  };\r\n\r\n  // 赋值头像\r\n  useEffect(() => {\r\n    if (avatar) {\r\n      const img = new Image();\r\n      img.src = avatar;\r\n      img.onload = (): void => {\r\n        setAvatarBase64(avatar);\r\n      };\r\n    }\r\n  }, [avatar]);\r\n  return (\r\n    <>\r\n      <PersonBg>\r\n        <PersonBgInner bg={avatarStr} />\r\n        <PersonInner>\r\n          <AvatarBox id=\"avatar_box\">\r\n            <Avatar src={avatarStr} />\r\n            <AvatarUpload\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              onChange={(e): void => getImg(e)}\r\n            />\r\n          </AvatarBox>\r\n          <NickBox>\r\n            <NickName>{nickName}</NickName>\r\n            <Sign>{signature}</Sign>\r\n          </NickBox>\r\n        </PersonInner>\r\n      </PersonBg>\r\n      <FucList>\r\n        <FucListItem onClick={(): void => history.push('/record')}>\r\n          <FucListItemTop />\r\n          <FucListItemBottom>练习记录</FucListItemBottom>\r\n        </FucListItem>\r\n      </FucList>\r\n      <MenuBox>\r\n        <MenuItem onClick={(): void => handleMenu('personal')}>\r\n          <MenuLabel>\r\n            <MenuIcon className=\"iconfont icon-personal\" />\r\n            个人信息\r\n          </MenuLabel>\r\n        </MenuItem>\r\n        <MenuItem onClick={(): void => handleMenu('msg')}>\r\n          <MenuLabel>\r\n            <MenuIcon className=\"iconfont icon-msg\" />\r\n            消息中心\r\n          </MenuLabel>\r\n          <MsgNum>{msgNum?.getUnreadMessageCount || 0}</MsgNum>\r\n        </MenuItem>\r\n        <MenuItem onClick={(): void => handleMenu('setting')}>\r\n          <MenuLabel>\r\n            <MenuIcon className=\"iconfont icon-setting\" />\r\n            通用设定\r\n          </MenuLabel>\r\n        </MenuItem>\r\n      </MenuBox>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default UserCenter;\r\n","import React, { useCallback, useEffect, useState } from 'react';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport TabBar from '@/components/TabBar';\nimport Library from '../Library';\nimport Find from '../Find';\nimport UserCenter from '../UserCenter';\n\nconst Home: React.FC = (props) => {\n  const [type, setType] = useState(''); // 设置标签页\n\n  const history = useHistory();\n  const location = useLocation();\n\n  // 初始化页面访问类型\n  useEffect(() => {\n    console.log(location);\n    const { pathname } = location;\n    switch (pathname) {\n      case '/library':\n        setType('library');\n        break;\n      case '/find':\n        setType('find');\n        break;\n      case '/user-center':\n        setType('user-center');\n        break;\n      default:\n    }\n  }, [location]);\n\n  // 点击footer\n  const handleClick = useCallback(\n    (clickType: string): void => {\n      history.push(`/${clickType}`);\n    },\n    [history]\n  );\n  return (\n    <div>\n      {type === 'library' && <Library />}\n      {type === 'find' && <Find />}\n      {type === 'user-center' && <UserCenter />}\n      <TabBar handelClick={handleClick} type={type} />\n    </div>\n  );\n};\n\nexport default Home;\n"],"sourceRoot":""}