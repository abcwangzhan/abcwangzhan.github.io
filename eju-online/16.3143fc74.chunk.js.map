{"version":3,"sources":["pages/Login/CompleteShow/CompleteShow.tsx"],"names":["Step","CompleteShow","useState","goalSchool","setGoalSchool","history","useHistory","useQuery","USER_SHOW","fetchPolicy","data","getUserInfo","nickName","as","artScience","es","ejuSubject","birthday","gd","gender","region","dg","degree","japaneseAbility","englishAbility","gs","ejuPoint","useEffect","APIHelper","getSchool","then","res","filterArr","getGoalSchool","size","direction","current","editable","value","labelNumber","getLabelFromValue","val","addressData","district","addressArr","forEach","item","push","label","children","length","item2","item3","join","getAdressDesc","japaneseAbilityCertificate","certificate","point","englishAbilityCertificate","ejuPointValue","toString","getEjuPoint","type","onClick"],"mappings":"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","file":"16.3143fc74.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { WhiteSpace, Steps, List, InputItem } from 'antd-mobile';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { useQuery } from '@apollo/client';\r\nimport APIHelper, { USER_SHOW } from '@/helpers/APIHelper';\r\nimport district from '@/constants/district.json';\r\nimport {\r\n  artScience,\r\n  ejuSubject,\r\n  gender,\r\n  degree,\r\n  japaneseAbilityCertificate,\r\n  englishAbilityCertificate,\r\n} from '@/constants/globalDatas';\r\nimport getLabelFromValue from '@/utils/getLabelFromValue';\r\nimport getGoalSchool, { PickDataItem } from '@/utils/getGoalSchool';\r\nimport { Page, PageTitle, PrimaryButton } from '../styles';\r\n\r\nconst { Step } = Steps;\r\nconst CompleteShow: React.FC = () => {\r\n  const [goalSchool, setGoalSchool] = useState<PickDataItem[]>([]); // 目标院校列表\r\n  const history = useHistory();\r\n  const { data } = useQuery(USER_SHOW, {\r\n    fetchPolicy: 'cache-and-network',\r\n  });\r\n  console.log('data++++=', data);\r\n  const { getUserInfo = {} } = data || {};\r\n  const {\r\n    nickName,\r\n    artScience: as,\r\n    ejuSubject: es,\r\n    birthday,\r\n    gender: gd,\r\n    region,\r\n    degree: dg,\r\n    japaneseAbility,\r\n    englishAbility,\r\n    goalSchool: gs,\r\n    ejuPoint,\r\n  } = getUserInfo;\r\n\r\n  // 获取留考最高成绩\r\n  const getEjuPoint = (): string => {\r\n    let ejuPointValue = 0;\r\n    ejuPoint?.forEach((item: { subject: string; point: number }) => {\r\n      if (item?.point) {\r\n        ejuPointValue += item.point;\r\n      }\r\n    });\r\n    return ejuPointValue.toString();\r\n  };\r\n\r\n  // 获取地址描述\r\n  const getAdressDesc = (val: string[]): string => {\r\n    const addressData = district.data;\r\n    const addressArr: string[] = [];\r\n    console.log('addressData++++', addressData);\r\n    // TODO 优化为递归调用\r\n    if (val) {\r\n      addressData.forEach((item) => {\r\n        if (item.value === val[0]) {\r\n          addressArr.push(item.label);\r\n          if (item?.children?.length > 0) {\r\n            item.children.forEach((item2) => {\r\n              if (item2.value === val[1]) {\r\n                addressArr.push(item2.label);\r\n                if (item2?.children?.length > 0) {\r\n                  item2.children.forEach((item3) => {\r\n                    if (item3.value === val[2]) {\r\n                      addressArr.push(item3.label);\r\n                    }\r\n                  });\r\n                }\r\n              }\r\n            });\r\n          }\r\n        }\r\n      });\r\n    }\r\n    return addressArr.join(',');\r\n  };\r\n\r\n  useEffect(() => {\r\n    // 初始化获得目标院校\r\n    APIHelper.getSchool().then((res) => {\r\n      const filterArr = getGoalSchool(res.data);\r\n      setGoalSchool(filterArr);\r\n    });\r\n  }, []);\r\n  return (\r\n    <>\r\n      <Page>\r\n        <PageTitle>请完善您的信息</PageTitle>\r\n        <WhiteSpace size=\"xl\" />\r\n        <Steps direction=\"horizontal\" current={2}>\r\n          <Step />\r\n          <Step />\r\n          <Step />\r\n        </Steps>\r\n        <WhiteSpace size=\"xl\" />\r\n        <List>\r\n          <InputItem editable={false} value={nickName} labelNumber={7}>\r\n            昵称:\r\n          </InputItem>\r\n          <InputItem\r\n            editable={false}\r\n            value={getLabelFromValue(artScience, as)}\r\n            labelNumber={7}\r\n          >\r\n            文理:\r\n          </InputItem>\r\n          <InputItem\r\n            editable={false}\r\n            value={getLabelFromValue(ejuSubject, es)}\r\n            labelNumber={7}\r\n          >\r\n            考学科目:\r\n          </InputItem>\r\n          <InputItem editable={false} value={birthday} labelNumber={7}>\r\n            出生日期:\r\n          </InputItem>\r\n          <InputItem\r\n            editable={false}\r\n            value={getLabelFromValue(gender, gd)}\r\n            labelNumber={7}\r\n          >\r\n            性别:\r\n          </InputItem>\r\n          <InputItem\r\n            editable={false}\r\n            value={getAdressDesc(region)}\r\n            labelNumber={7}\r\n          >\r\n            国内地区:\r\n          </InputItem>\r\n          <InputItem\r\n            editable={false}\r\n            value={getLabelFromValue(degree, dg)}\r\n            labelNumber={7}\r\n          >\r\n            最终学历:\r\n          </InputItem>\r\n          <InputItem\r\n            editable={false}\r\n            value={`${getLabelFromValue(\r\n              japaneseAbilityCertificate,\r\n              japaneseAbility?.[0].certificate\r\n            )}-${japaneseAbility?.[0].point}`}\r\n            labelNumber={7}\r\n          >\r\n            日语能力:\r\n          </InputItem>\r\n          <InputItem\r\n            editable={false}\r\n            value={`${getLabelFromValue(\r\n              englishAbilityCertificate,\r\n              englishAbility?.[0].certificate\r\n            )}-${englishAbility?.[0].point}`}\r\n            labelNumber={7}\r\n          >\r\n            英语能力:\r\n          </InputItem>\r\n          <InputItem\r\n            editable={false}\r\n            value={getLabelFromValue(goalSchool, gs)}\r\n            labelNumber={7}\r\n          >\r\n            目标大学:\r\n          </InputItem>\r\n          <InputItem editable={false} value={getEjuPoint()} labelNumber={7}>\r\n            留考最高成绩:\r\n          </InputItem>\r\n          <WhiteSpace size=\"xl\" />\r\n        </List>\r\n        <PrimaryButton\r\n          type=\"primary\"\r\n          onClick={(): void => history.push('/library')}\r\n        >\r\n          确认\r\n        </PrimaryButton>\r\n        <WhiteSpace size=\"xl\" />\r\n        <WhiteSpace size=\"xl\" />\r\n      </Page>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CompleteShow;\r\n"],"sourceRoot":""}